!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){!function(e){if(!e.wap2app){var t="2.7.3";i(2);var n=i(6),a=i(7),o=i(8),s=i(10),r=i(11),h=i(15),p=i(9),l=i(16),c=i(18),d=i(19),u=i(20),w=i(21),v=i(13),f=i(22),b=i(17),m=i(23),g=i(24),_=i(14),y=i(25),W=i(26),x=i(12),k=i(27),T=i(28),I=i(38),O=i(40),A=i(36),S=!1,E=!1,C=!1,V=!1,B=!1,R=function(t){e.__wap2app_init||(e.__wap2app_init=!0,wap2app.shortcutConfig=t.shortcut||!1,n.plusReady(function(){E=new I(t);var i=plus.webview.currentWebview();S=i.id;b();B=plus.webview.getWebviewById(v.W2A_CONTEXT_ID),setTimeout(function(){var t=S===plus.runtime.appid;if(!t){var i=plus.webview.getLaunchWebview();i&&i.id===S&&(t=!0)}if(t){plus.storage.removeItem(v.W2A_CONTEXT_READY);var a=new O(E);if("file:"===e.location.protocol)a.handleOldVersion();else{if(B){if(n.isDev()&&plus.webview.getSecondWebview){var s=plus.webview.getSecondWebview();s&&s.id===v.W2A_CONTEXT_ID&&(s.appendJsFile("_www/__wap2app.js"),s.appendJsFile("_www/__wap2appconfig.js"))}plus.storage.setItem(v.W2A_CONTEXT_READY,"TRUE")}else o.plusReady(),J();"about:"!==e.location.protocol&&F(S)}}else S===v.W2A_CONTEXT_ID?(V=new T(E),plus.storage.setItem(v.W2A_CONTEXT_READY,"TRUE")):F(S)},0)}))},L=function(e,t,i,n){"undefined"==typeof n&&(n=!0),V?V.open("blank",plus.webview.getWebviewById(i||plus.runtime.appid),e,t,"href",n):B&&B.evalJS("window.wap2app&&wap2app.open('"+e+"','"+(t||"")+"','"+(i||S)+"',"+n+")")},P=function(e){C&&!e?C.openShare():e&&(V?V.openShare(e):B&&B.evalJS("window.wap2app&&wap2app.openShare("+JSON.stringify(e)+")"))},D=function(e,t){return"undefined"==typeof t&&(t=!0),V?void V.back(e,t):C?void C.back():void(S&&(S===plus.runtime.appid||plus.webview.currentWebview().__wap2app_index?q():plus.webview.currentWebview().close("slide-out-right",300)))},U=function(){V?V.close():B&&B.evalJS("window.wap2app&&wap2app.close()")},j=function(e){e=e||"",V?("string"==typeof e&&(e=JSON.parse(e)),V.show(e)):("object"==typeof e&&(e=JSON.stringify(e)),B&&B.evalJS("window.wap2app&&wap2app.show('"+e+"')"))},N=function(e){C&&C.fixed(e)},H=!1,M=!1,q=function(){if(H&&H.isVisible()){n.now();if(M)return;M=!0,plus.runtime.quit()}else H=d('\u518d\u6309\u4e00\u6b21\u8fd4\u56de\u952e\u9000\u51fa<br>\u70b9\u6b64\u53ef&nbsp;<span style="border-bottom:1px solid #fff" onclick="wap2app.openFeedback();">\u53cd\u9988\u610f\u89c1</span>')},J=function(){var e={opacity:0,zindex:-2,popGesture:"none"};B=plus.webview.create("_www/__wap2appcontext.html",v.W2A_CONTEXT_ID,e),B.show("none");var t=plus.webview.currentWebview();t.isVisible()&&t.show("none")},F=function(e){C||(C=new k(E.getWebviewOptionsById(e)))},G="__W2A_FEEDBACK",z=function(){plus.nativeUI.showWaiting();var e=E.globalOptions.feedback,t=e.url,i=e.params;"function"==typeof i&&(i=i()),n.isObject(i)&&(t=p.appendQuery(t,wap2app.extend(i,{p:"Android"===plus.os.name?"a":"iOS"===plus.os.name?"i":"",plus_version:plus.runtime.innerVersion,vendor:plus.device.vendor,md:plus.device.model})));var a=plus.webview.create(t,G,{statusbar:{background:"#f7f7f7"}});a.addEventListener("titleUpdate",function(){plus.nativeUI.closeWaiting(),a.show("slide-in-right",300)})},X=function(e,t){V?V.preload(e,t||plus.runtime.appid):B&&B.evalJS('window.wap2app&&wap2app.preload("'+e+'","'+(t||S)+'")')},Y=function(e){V?V.destroy(e):B&&B.evalJS('window.wap2app&&wap2app.destroy("'+e+'")')},$=function(e){V?V.updateOptions({back:{backbutton:!!e}}):B&&B.evalJS("window.wap2app&&wap2app.setBackbutton("+!!e+")")},K=function(e,t){V?V.switchTab(e,t):B&&B.evalJS('window.wap2app&&wap2app.switchTab("'+e+'","'+t+'")')},Q=function(e){return V?V.getCurrentTabWebview(e||plus.runtime.appid):void 0},Z=function(){C&&C.bijia()};e.wap2app={version:t,os:a,log:o,SPA:s,dom:r,util:n,now:n.now,init:R,gps:i(30),config:function(e){try{e()}catch(t){console.error(t)}},show:j,open:L,quit:q,back:D,close:U,fixed:N,destroy:Y,preload:X,switchTab:K,ajax:p,order:c,toast:d,report:u,bijia:l,setting:w,trigger:r.trigger,plusReady:n.plusReady,domReady:r.ready,extend:n.extend,iframe:m,confirm:g,support:_,openShare:P,openFeedback:z,previewImage:y,getStyles:r.getStyles,getCookie:f.get,setCookie:f.set,removeCookie:f.remove,injectStyle:r.injectStyle,getLocation:r.getLocation,setBackbutton:$,getCurrentTabWebview:Q,refreshBijia:Z,W2ANView:W,fallback:{changeDock:function(e){V?V.changeDock(e):B&&B.evalJS("window.wap2app&&wap2app.fallback.changeDock("+e+")")}},ge:function(e){return-1!==n.versionCompare(t,e)},lt:function(e){return-1===n.versionCompare(t,t)},share:{init:h.init,open:function(t){t=t||{title:document.title,content:document.title,href:e.location.href},"string"==typeof t&&(t=JSON.parse(t)),P(t)}},getContext:function(){return V},isConfiged:function(e){return E.isConfiged(e)},getW2AOptions:function(){return E},currentWebview:function(){if(V){var e=V.currentContext();if(e){if(e instanceof A)return e.webview;if(e instanceof plus.webview.Webview)return e}return plus.webview.getTopWebview()}return plus.webview.getTopWebview()},currentW2AWebview:function(){return C},getArgs:b,createW2AView:function(e,t,i){var n=i&&plus.webview.getWebviewById(i);return n||(n=plus.webview.currentWebview()),new x(e,n,t)}}}}(window)},function(e,t,i){i(3),i(4),i(5)},function(e,t){Function.prototype.bind=Function.prototype.bind||function(e){var t=Array.prototype.splice.call(arguments,1),i=this,n=function(){var a=t.concat(Array.prototype.splice.call(arguments,0));return this instanceof n?void i.apply(this,a):i.apply(e,a)};return n.prototype=i.prototype,n}},function(e,t){function i(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("Events"),n=!0;for(var a in t)"bubbles"===a?n=!!t[a]:i[a]=t[a];return i.initEvent(e,n,!0),i}"undefined"==typeof window.CustomEvent&&(i.prototype=window.Event.prototype,window.CustomEvent=i)},function(e,t){document.elementFromPoint&&(document.elementsFromPoint||(document.elementsFromPoint=function(e,t){for(var i,n,a,o=[],s=[];(i=document.elementFromPoint(e,t))&&-1===o.indexOf(i)&&null!=i;)o.push(i),s.push({value:i.style.getPropertyValue("pointer-events"),priority:i.style.getPropertyPriority("pointer-events")}),i.style.setProperty("pointer-events","none","important");for(n=s.length;a=s[--n];)o[n].style.setProperty("pointer-events",a.value?a.value:"",a.priority);return o}))},function(e,t){var i=Array.isArray||function(e){return e instanceof Array},n=function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype},a=function(e,t){if(t)for(var i in t){var o=e[i],s=t[i];n(s)?e[i]=a(o&&n(o)?o:{},s):"undefined"!==s&&(e[i]=s)}return e},o=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];i&&n(i)&&a(e,i)}return e},s=function(e,t,n){return"string"==typeof t?t===e:"function"==typeof t?(n.splice(0,0,e),t.apply(null,n)):i(t)?~t.indexOf(e):t instanceof RegExp?t.test(e):!1},r=function(e,t,i){var n=!0;return i=i||[],i.splice(0,0,e),t.matchHostnames&&(n=s(e.hostname,t.matchHostnames,i),"function"==typeof t.matchHostnames&&i.splice(0,1),null!==n&&!n)?!1:t.matchPathnames&&(n=s(e.pathname,t.matchPathnames,i),"function"==typeof t.matchHostnames&&i.splice(0,1),null!==n&&!n)?!1:t.title&&e.title&&(n=s(e.title,t.title,i),null!==n&&!n)?!1:n},h=function(e){window.plus&&window.plus.isReady?e():document.addEventListener("plusready",function(){e()},!1)},p=/\+/g,l=/([^&=]+)=?([^&]*)/g,c=function(e){var t={};if(e){var i=e.split("?");2===i.length&&(e=i[1])}if(e)for(var n;n=l.exec(e);)t[d(n[1])]=d(n[2]);return t},d=function(e){return decodeURIComponent(e.replace(p," "))},u=function(e,t){var i=c(t||location.search);return i.hasOwnProperty(e)?i[e]:""},w=Date.now||function(){return(new Date).getTime()},v=function(e,t,i){var n,a,o,s,r=0;i||(i={});var h=function(){r=i.leading===!1?0:w(),n=null,s=e.apply(a,o),n||(a=o=null)},p=function(){var p=w();r||i.leading!==!1||(r=p);var l=t-(p-r);return a=this,o=arguments,0>=l||l>t?(n&&(clearTimeout(n),n=null),r=p,s=e.apply(a,o),n||(a=o=null)):n||i.trailing===!1||(n=setTimeout(h,l)),s};return p.cancel=function(){clearTimeout(n),r=0,n=a=o=null},p},f=function(e,t,i){return e>i.left&&e<i.left+i.width&&t>i.top&&t<i.top+i.height},b=function(e,t){if(typeof e+typeof t!="stringstring")return!1;for(var i=e.split("."),n=t.split("."),a=0,o=Math.max(i.length,n.length);o>a;a++){if(i[a]&&!n[a]&&parseInt(i[a])>0||parseInt(i[a])>parseInt(n[a]))return 1;if(n[a]&&!i[a]&&parseInt(n[a])>0||parseInt(i[a])<parseInt(n[a]))return-1}return 0},m=function(){if(plus.runtime.isApplicationExist)return!!plus.runtime.isApplicationExist({pname:"com.tencent.mm",action:"weixin://"});if("Android"!==plus.os.name)return plus.ios["import"]("WXApi").isWXAppInstalled();try{var e=plus.android.runtimeMainActivity().getPackageManager(),t=plus.android.importClass(e);return!!e.getPackageInfo("com.tencent.mm",t.GET_ACTIVITIES)}catch(i){}},g=function(){if(plus){var e=plus.runtime.innerVersion.split(".");return parseInt(e[e.length-1])}return 0},_=function(){return"HBuilder"===plus.runtime.appid},y={};h(function(){var e=plus.screen.resolutionHeight-plus.navigator.getStatusbarHeight();y={height:e,availHeight:e-(plus.nativeUI.getTitlebarHeight&&plus.nativeUI.getTitlebarHeight()||0)}});var W=function(){return y},x=function(e,t){if(!e)return"";t=t||20;for(var i=0,n=e.length,a=new String,o=0;n>o;o++){var s=e.charAt(o);if(i++,escape(s).length>4&&i++,a=a.concat(s),i>=t)return a=a.concat("...")}return e},k=0,T=0;e.exports={now:w,time:function(e){var t=w();e&&(k=t,T=t),k||(k=t,T=t);var i=t-T;return T=w(),"[\u8017\u65f6\uff1a"+(t-k)+"\uff0c"+i+"]"},isDev:_,isObject:n,isArray:i,isMatch:r,extend:o,ellipsis:x,isCross:f,throttle:v,getScreen:W,plusReady:h,parseParams:c,getUrlParam:u,versionCompare:b,isWechatInstalled:m,getRuntimeInnerVersion:g}},function(e,t){var i={android:!1,ios:!1,plus:!1,stream:!1,qihoo:!1,qihoobrowser:!1,wkwebview:!1},n=navigator.userAgent;n.match(/(Android);?[\s\/]+([\d.]+)?/)?i.android=!0:(n.match(/(iPhone\sOS)\s([\d_]+)/)||n.match(/(iPad).*OS\s([\d_]+)/))&&(i.ios=!0,window.webkit&&window.webkit.messageHandlers&&(i.wkwebview=!0)),n.match(/Html5Plus/i)&&(i.plus=!0,n.match(/StreamApp/i)&&(i.stream=!0,n.match(/qihoobrowser/i)?i.qihoobrowser=!0:n.match(/Qihoo/i)&&(i.qihoo=!0))),e.exports=i},function(e,t,i){var n=(i(6),i(9)),a=function(e,t){var i={appid:plus.runtime.appid,av:plus.runtime.version,imei:plus.storage.getItem("__DEVICE_ID")||plus.device.imei,vendor:plus.device.vendor,launcher:o(),model:plus.device.model,os:plus.os.version,lv:"",vb:plus.runtime.innerVersion,type:e,net:plus.networkinfo.getCurrentType(),sf:plus.runtime.launcher,message:t||"",w2a_version:wap2app.version};n.post("https://stream.dcloud.net.cn/frontend/startup",i,function(){})},o=function(){try{var e=plus.android.runtimeMainActivity(),t=plus.android.importClass("android.content.Intent"),i=new t("android.intent.action.MAIN");i.addCategory("android.intent.category.HOME"),plus.android.importClass("android.content.pm.PackageManager"),plus.android.importClass("android.content.pm.ResolveInfo");var n=e.getPackageManager(),a=n.resolveActivity(i,0);if(a){var o=a.plusGetAttribute("activityInfo");if(o){var s=o.plusGetAttribute("packageName");if(s&&"android"!==s)return s}}}catch(r){console.error&&console.error(r)}return""};e.exports={plusReady:function(){a(1)},pause:function(){a(2)},resume:function(e){a(3,e)},quit:function(){a(4)}}},function(e,t,i){var n=function(e){var t=[];if(e)for(var i in e)e.hasOwnProperty(i)&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t.length?t.join("&"):""},a=function(e,t){return"string"!=typeof t&&(t=n(t)),(e+"&"+t).replace(/[&?]{1,2}/,"?")},o=function(e,t,i,o){"function"==typeof i&&(o=i,i=!1);var s=new plus.net.XMLHttpRequest;o&&(s.onreadystatechange=function(){4==s.readyState&&(200==s.status?o&&o(JSON.parse(s.responseText)):o&&o(!1))});var r=n(i);r&&"GET"===e&&(t=a(t,r)),s.open(e,t),"POST"===e&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send("POST"===e?r:!1)};e.exports={post:function(e,t,i){o("POST",e,t,i)},get:function(e,t,i){o("GET",e,t,i)},serializeData:n,appendQuery:a}},function(e,t,i){var n=i(6),a=i(11),o=i(12),s=!1,r=[],h=function(e,t,i,a,h){busying=!0;var l=e,c=!1;n.isObject(e)&&(l=e.url,c=e.screenshot),"string"==typeof t&&(a=i,i=t,t=!1),i=i||plus.webview.currentWebview().id;var d=plus.webview.getWebviewById(i);wap2app.getContext()&&(r=wap2app.getContext().getWebviewContextById(i).history);var u=function(e,i){s=e,a===!0?d.evalJS('location.replace("'+l+'")'):a===!1&&d.evalJS('location.href="'+l+'"'),t&&t(e,i)},e=wap2app.getW2AOptions().getWebviewOptionsByUrl(l);if(e.screenshot&&e.screenshot.url&&(c=e.screenshot),!c||!c.url)return void u(!1);var w=function(){var t=new o(p(l,c),d,c);t.show(e.show.aniShow,e.show.duration,function(i){i?u(t,e):u(!1),h||setTimeout(function(){t.close(c.animation.type,c.animation.duration,function(){setTimeout(function(){t.clear()},c.animation.delay)})},e.delay)})},v=new plus.nativeObj.Bitmap(l+"_"+Math.random());d.draw(v,function(){!a&&r.push(v.id),w()},function(){v.clear(),v=null,!a&&r.push(!1),w()})},p=function(e,t){if("function"==typeof t.handle){var i=a.getLocation(e);return t.handle(i.pathname,i)}return t.url},l=function(e,t,i,a){if(!s||!s.isVisible()){var h=!1,p=!1;"string"==typeof i?(h=i,p=plus.webview.getWebviewById(h),i=function(e){p&&p.back()},wap2app.getContext()&&(r=wap2app.getContext().getWebviewContextById(h).history)):(p=plus.webview.currentWebview(),h=p.id),"string"==typeof a&&(a=JSON.parse(a)),e=e||"pop-out",t=t||200,a=n.extend({showWaiting:!1,delay:200,animation:{type:"shrink",duration:200,delay:0,frames:12,region:{top:"0px",bottom:"0px",left:"0px",right:"0px"}}},a);var l=r.pop();if(l){var c=new o(l,p,{animation:a.animation});c.show(e,t,function(e){e?i&&i(!0,function(){a.showWaiting&&plus.nativeUI.showWaiting(),setTimeout(function(){c.close("shrink",200,function(){c.clear();var e=plus.nativeObj.Bitmap.getBitmapById(l);e&&e.clear(),a.showWaiting&&plus.nativeUI.closeWaiting()})},a.delay)}):i&&i(!1)})}else i&&i(!1)}};e.exports={open:h,back:l}},function(e,t,i){var n,a=i(6),o=/complete|loaded|interactive/,s=function(e){o.test(document.readyState)?e():document.addEventListener("DOMContentLoaded",function(){e()},!1)},r=function(e,t,i,n){e&&(t=t||"click",n=a.extend({fastclick:{className:"needsclick"}},n||{}),"click"===t&&n.fastclick&&(e.className=e.className+" "+n.fastclick.className),e.dispatchEvent(new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0})),"click"===t&&n.fastclick&&(e.className=e.className.replace(" "+n.fastclick.className,"")))},h=function(e){var t=function(){var t=document.createElement("style");t.appendChild(document.createTextNode(e)),document.head.appendChild(t)};document.head?t():s(function(){t()})},p=function(e,t){var i=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?i.getPropertyValue(t)||i[t]:i},l=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},c=["hash","host","hostname","href","origin","pathname","port","protocol","search"],d=document.createElement("a"),u=function(e,t){d.href=e;for(var i={title:t},n=0,a=c.length;a>n;n++){var o=c[n];i[o]=d[o]}return i},w=function(e,t,i){var n={};a.isObject(i)?(n=i,n.expires=0===n.expires?0:n.expires||1):n.expires=0===i?0:i||1;var o=new Date;o.setTime(o.getTime()+24*n.expires*60*60*1e3);var s="expires="+o.toUTCString(),r=n.path||"/",h=n.domain||"";document.cookie=e+"="+t+"; path="+r+"; "+(h?"domain="+h+"; ":"")+s+"; "},v=function(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var a=i[n];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""},f=function(e,t){a.isObject(t)||(t={}),t.expires=-1,w(e,"",t)},b=function(e){return"string"==typeof e&&(e=document.querySelector(e)),e?"none"!==p(e,"display")&&e.offsetHeight>0&&e.offsetWidth>0:!1},m=function(){if(null!=n)return n;var e=window.pageXOffset?window.pageXOffset+window.innerWidth-1:0,t=window.pageYOffset?window.pageYOffset+window.innerHeight-1:0;return 0===e&&0===t?!0:n=!document.elementFromPoint(e,t)},g=function(e,t){return document.elementFromPoint?(m()||(e+=window.pageXOffset,t+=window.pageYOffset),document.elementFromPoint(e,t)):!1},_=function(e,t){return document.elementsFromPoint?(m()||(e+=window.pageXOffset,t+=window.pageYOffset),document.elementsFromPoint(e,t)):!1},y=/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*(?:\.\d+)?)\)$/,W=function(e){var t=e.match(y);return t&&5===t.length?[t[1],t[2],t[3],t[4]]:!1},x=function(e){e=e||{x:30,y:30};var t=_(e.x,e.y);if(!t)return!1;for(var i=document.documentElement,n=document.body,a=0,o=t.length;o>a;a++){var s=t[a];if(s!==n&&s!==i)return!1}return!0},k=function(e){return!(!e||!~e.innerText.indexOf("\u4e0b\u8f7d"))},T=function(e,t){if(!e)return!1;if("string"==typeof e&&(e=document.querySelector(e)),!e)return!1;t=t||{x:1,y:100};var i=e.offsetWidth,n=e.offsetHeight,a=window.innerWidth-2*t.x,o=window.innerHeight-2*t.y;if(!(i>0&&n>0&&i>=a&&n>=o))return!1;var s=p(e),r=function(e,t){return e.getPropertyValue(t)||e[t]},h=r(s,"opacity");if(1>h&&h>0)return!0;var l=W(r(s,"backgroundColor"));if(l){var c=parseFloat(l[3]);if(1>c&&c>0)return!0}return!1},I=function(e){if(!e)return!0;var t=e.point,i=e.minWidth,n=e.maxHeight,a=e.handle||function(e){return e.offsetWidth>=i&&e.offsetHeight<=n},o=_(t.x,t.y);if(o){for(var s=document.documentElement,r=document.body,h=0,p=o.length;p>h;h++){var l=o[h];if(l===r||l===s)break;var c=a(l);if(c!==!1)return l}return!1}return!0},O=function(){return document.documentElement?document.documentElement.clientWidth:plus?plus.screen.resolutionWidth:0};e.exports={clientWidth:O(),ready:s,trigger:r,getRGBA:W,setCookie:w,getCookie:v,removeCookie:f,isVisible:b,getStyles:p,getLocation:u,injectStyle:h,elementMatch:l,detectHead:I,detectMask:T,detectBlank:x,detectDownloadTips:k,elementFromPoint:g,elementsFromPoint:_}},function(e,t,i){var n=i(6),a=i(7),o=i(13),s=i(14),r=function(e,t,i,a){this.id=e,n.isObject(t)?(this.styles=t,this.webview=i,this.options=a):(this.options=i,this.webview=t,this.styles=!1),this.view=!1,this.bitmap=!1,this.isRecycle=!0,this.visible=!1,this.animated=!1,this.title=!1,this.aniShow="pop-in",this.stopped=!1,this.drewTexts=!1,this.firstView=!1,this.secondView=!1,this.w2aContext=wap2app.getContext(),this._init()},h=r.prototype;h._init=function(){if(this.styles)this.view=new plus.nativeObj.View(this.id,this.styles);else{if(this.bitmap=this._getBitmapById(this.id),!this.bitmap)return;this.view=this._getViewById(o.W2A_VIEW_ID)}},h._getViewById=function(e){return this.w2aContext?this.w2aContext.getViewById(e):plus.nativeObj.View.getViewById(e)},h._getBitmapById=function(e){return this.w2aContext?this.w2aContext.getBitmapById(e):plus.nativeObj.Bitmap.getBitmapById(e)},h.setTitle=function(e){e&&!this.title&&(this.title=e,this.drawTexts(this.view,[n.extend(this.options.title,{text:e})]))},h.show=function(e,t,i,n){if(this.aniShow=e,!this.view)return this.visible=!1,i&&i(!1),!1;if(!e||"none"===e){if(this.webview&&~[o.W2A_BITMAP_ID,o.W2A_OTHER_BITMAP_ID].indexOf(this.bitmap.id)){var r=this.webview;r=r.parent()||r,r.draw(this.bitmap,function(){this.visible=!0,this.animated=!1,this.view.drawBitmap(this.bitmap),this._drawRect(),this.drawTexts(this.view,this.options.drawText),this.view.show(),i&&i(!0)}.bind(this),function(e){this.visible=!1,i&&i(!1)})}else this.visible=!0,this.animated=!1,this.view.drawBitmap(this.bitmap),this._drawRect(),this.drawTexts(this.view,this.options.drawText),this.view.show(),i&&i(!0);return!0}if("slide-in-right"!==e&&"pop-in"!==e&&"pop-out"!==e&&(e="slide-in-right"),"slide-in-right"===e){if(this.visible=!0,this.animated=!1,a.android&&s.titlebar()&&plus.nativeUI.isTitlebarVisible()){var h=this.options.crop,p=plus.screen.resolutionHeight-plus.navigator.getStatusbarHeight(),l=p-plus.nativeUI.getTitlebarHeight(),c={top:0,height:l-h},d={top:p-h,height:h},u={top:l-h,height:h};this.view.drawBitmap(this.bitmap,c,c),this.view.drawBitmap(this.bitmap,d,u)}else this.view.drawBitmap(this.bitmap);return this.drawTexts(this.view,this.options.drawText),this.firstView=this.view,this.secondView=null,plus.nativeObj.View.startAnimation({type:e,duration:t},this.firstView,this.secondView,function(){n&&n(!0)}),i&&i(!0),!0}this.relatedView=this._getViewById(o.W2A_OTHER_VIEW_ID);var w=this._getBitmapById(o.W2A_OTHER_BITMAP_ID);if(this.relatedView&&w){var r=this.webview,v=function(a){this.visible=!0,this.animated=!1,this.view.drawBitmap(this.bitmap),a&&(this.relatedView={bitmap:a}),this.drawTexts(this.view,this.options.drawText),this.firstView=this.relatedView,this.secondView=this.view,"pop-out"===e&&(this.firstView=this.view,this.secondView=this.relatedView),plus.nativeObj.View.startAnimation({type:e,duration:t},this.firstView,this.secondView,function(){n&&n(!0)}),i&&i(!0)};if(!r)return void("pop-in"===e||"pop-out"===e?v.call(this,!1):(this.visible=!1,i&&i(!1)));r=r.parent()||r,r.draw(w,function(){v.call(this,w)}.bind(this),function(t){"pop-in"===e||"pop-out"===e?v.call(this,!1):(this.visible=!1,i&&i(!1))}.bind(this))}else this.visible=!1,i&&i(!1)},h.back=function(e,t,i){var n=this,a=function(){plus.nativeObj.View.clearAnimation(),n.hide(),n.reset(),n.recycle(),n.visible=!1};"function"==typeof this.view.setTouchEventRect&&this.firstView?plus.nativeObj.View.startAnimation({type:e,duration:t},this.firstView,this.secondView,function(){a()}):a()},h.close=function(e,t,i){if(this.visible){var n=this.options.animation;"pop-out"===this.aniShow?(this.animated=!0,i&&i(!0)):this.view.animate({type:e,duration:t,frames:n.frames,region:n.region},function(){typeof this.view.setTouchEventRect&&this.view.setTouchEventRect({top:"0px",left:"0px",width:"100%",height:"60px"}),"function"==typeof this.view.interceptTouchEvent&&this.view.interceptTouchEvent(!1),this.animated=!0,i&&i(!0)}.bind(this))}else i&&i(!1)},h.setStopped=function(e){this.stopped=e},h.clear=function(e){this.visible&&(this.stopped,this.animated?(plus.nativeObj.View.clearAnimation(),this.hide(),this.reset(),this.recycle(),this.visible=!1,e&&e()):this.clearTimer=setTimeout(function(){this.clear(e)}.bind(this),200))},h.isVisible=function(){return this.visible},h.hide=function(){var e=this._getViewById(o.W2A_VIEW_ID);e&&e.hide(),e=this._getViewById(o.W2A_OTHER_VIEW_ID),e&&e.hide()},h.reset=function(){var e=this._getViewById(o.W2A_VIEW_ID);e&&(e.reset(),typeof e.setTouchEventRect&&e.setTouchEventRect({top:"0px",left:"0px",width:"100%",height:"100%"}),"function"==typeof e.interceptTouchEvent&&e.interceptTouchEvent(!0)),e=this._getViewById(o.W2A_OTHER_VIEW_ID),e&&e.reset(),"function"==typeof e.interceptTouchEvent&&e.interceptTouchEvent(!0)},h.setRecycle=function(e){this.isRecycle=e,!this.isRecycle},h.recycle=function(){if(s.bitmapRecycle()){var e=this._getViewById(o.W2A_BITMAP_ID);e&&e.recycle&&e.recycle(),e=this._getViewById(o.W2A_OTHER_BITMAP_ID),e&&e.recycle&&e.recycle(),this.isRecycle&&this.bitmap&&!~[o.W2A_BITMAP_ID,o.W2A_OTHER_BITMAP_ID].indexOf(this.bitmap.id)&&"_header"!==this.bitmap.id.substr(-7)&&this.bitmap.recycle&&this.bitmap.recycle()}},h._drawRect=function(){if(this.options.matchPathnames){var e=this.options.placeholder,t=this.options.animation.region,i=this._getDst(t.top),n=this._getDst(t.bottom),a=window.innerHeight,o=plus.navigator.getStatusbarHeight();o&&(a=plus.screen.resolutionHeight-o),s.titlebar()&&plus.nativeUI.isTitlebarVisible()&&(a-=plus.nativeUI.getTitlebarHeight()),a=a-i-n,this.view.drawRect(e,{top:i,height:a})}},h._getDst=function(e){if("number"==typeof e)return parseInt(e,10);if("string"==typeof e){if(-1!==e.indexOf("px",e.length-2))return parseInt(e,10);var t=document.querySelector(e);return t&&t.offsetHeight||0}if("function"==typeof e){var e=parseInt(e(),10);return e||0}return 0},h._ellipsis=function(e,t){if(!e)return"";if(!t||e.replace(/[^\x00-\xff]/g,"**").length<=t)return e;for(var i=0,n="",a=0;a<e.length;a++)if(n+=e.charAt(a),e.charCodeAt(a)>128){if(i+=2,i>t)return n.substring(0,n.length-1)+"..."}else if(i+=1,i>t)return n.substring(0,n.length-2)+"...";return e},h.drawTexts=function(e,t){if("function"==typeof t&&(t=t(),t&&n.isObject(t)&&(t=[t])),t&&n.isArray(t)&&t.length){for(var i=0;i<t.length;i++){var a=t[i];if(a.text){var o=a.text;"function"==typeof o&&(o=o()),o&&(e.drawText(this._ellipsis(o,a.max||25),a.dst,a.styles),this.drewTexts=!0)}}return t}return!1},e.exports=r},function(e,t){e.exports={SCREENSHOT_PATH:"_www/__wap2app/screenshot/",W2A_WEBVIEW_ID:"__W2A_WEBVIEW_ID_",W2A_SCREENSHOT_WEBVIEW_ID:"__W2A_SCREENSHOT",W2A_SCREENSHOT_VERSION:"__W2A_SCREENSHOT_VERSION",W2A_LAUNCH_WEBVIEW_ID:"launch",W2A_CPS_WEBVIEW_ID:"__W2A_CPS",W2A_TEMPLATE_WEBVIEW_ID:"__W2A_TEMPLATE_",W2A_TEMPORARY_WEBVIEW_ID:"__W2A_TEMPORARY",W2A_APP_NAME:"__W2A_APP_NAME",W2A_CONTEXT_READY:"__W2A_READY",W2A_WEBVIEW_LOADING:"__W2A_WEBVIEW_LOADING_",W2A_WEBVIEW_BACKING:"__W2A_WEBVIEW_BACKING_",W2A_WEBVIEW_RELOAD:"__W2A_WEBVIEW_RELOAD_",W2A_BITMAP_ID:"__W2A_BITMAP",W2A_OTHER_BITMAP_ID:"__W2A_OTHER_BITMAP",W2A_WHITE_BITMAP_ID:"__W2A_WHITE_BITMAP",W2A_VIEW_ID:"__W2A_VIEW",W2A_OTHER_VIEW_ID:"__W2A_OTHER_VIEW",W2A_GROUP_SPLIT:"__W2A_GROUP__",W2A_CONTEXT_ID:"__W2A_CONTEXT_",W2A_BROWSER_ID:"__W2A_BROWSER_",W2A_TEMPLATE_DATA:"__W2A_TEMPLATE_DATA",W2A_OVERRIDE_IGNORE:["sms:","tel:","mailto:","callto:","weixin:","alipay:","alipayqr:","weibo:","mqq:","mqqapi:","qqmap:","baidumap:","amap:","iosamap:"],W2A_OVERRIDE_MATCH:"^(http|https|ftp|tel|mailto|callto|weixin|alipay|alipayqr|weibo|mqq|mqqapi).*",W2A_BROWSER_CHILD_ID:"__W2A_WEBVIEW_ID_BROWSER_CHILD_",W2A_GPS_TIME:"__W2A_GPS_TIME",W2A_ACTIVE_CLASS:"__W2A_ACTIVE",W2A_IFRAME_CLASS:"__W2A_IFRAME",W2A_IFRAME_STYLES:"-webkit-transform:translate(0px, -100%);position: fixed;background: transparent;left: 0;top: 0;right: 0;bottom: 0;width:100%;height:100%;z-index: 2147483647;border:0;"}},function(e,t,i){var n=i(7);e.exports={bijia:function(){var e=plus.runtime.innerVersion.split(".");return n.qihoobrowser&&parseInt(e[e.length-1])>=27821||n.ios&&parseInt(e[e.length-1])>=28988},titlebar:function(){var e=plus.runtime.innerVersion.split(".");return n.qihoobrowser&&plus.nativeUI.getTitlebarHeight||n.ios&&parseInt(e[e.length-1])>=28458},bitmapRecycle:function(){var e=plus.runtime.innerVersion.split(".");return parseInt(e[e.length-1])>=27035},nativeObj:function(){return plus.nativeObj.hasOwnProperty("View")},restore:function(){var e=plus.runtime.innerVersion.split(".");return parseInt(e[e.length-1])>=27610},webviewAnimate:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>=28431},shareWeixin:function(){return!n.qihoobrowser&&"com.mycheering.launcher"!==plus.runtime.channel},acceleration:function(){return!n.qihoobrowser&&"HUAWEI"!==plus.device.vendor},drag:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>=28613||n.ios&&parseInt(e[e.length-1])>=28988},pullToRefresh:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>=28679||n.ios&&parseInt(e[e.length-1])>=28988},nativeViewDraws:function(){var e=plus.runtime.innerVersion.split(".");return parseInt(e[e.length-1])>=29588||n.ios&&parseInt(e[e.length-1])>=29208},checkRenderedContent:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>=29588},navigationbarBack:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>30601||n.ios&&parseInt(e[e.length-1])>30284},subNView:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>=31050||n.ios&&parseInt(e[e.length-1])>31033},navigationbarTitle:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>=28878||n.ios},animationOptimization:function(){var e=plus.runtime.innerVersion.split(".");return n.android&&parseInt(e[e.length-1])>=31050}}},function(e,t,i){function n(e,t,i){var n=l[e];return n?void(n.authenticated?a(n,t,i):n.authorize(function(){a(n,t,i)},function(e){plus.nativeUI.alert("\u8ba4\u8bc1\u6388\u6743\u5931\u8d25"),i&&i(!1)})):(plus.nativeUI.alert("\u65e0\u6548\u7684\u5206\u4eab\u670d\u52a1["+e+"]"),void(i&&i(!1)))}function a(e,t,i){e.send(t,function(){plus.nativeUI.toast('\u5206\u4eab\u5230"'+e.description+'"\u6210\u529f\uff01'),i&&i(!0)},function(t){plus.nativeUI.toast('\u5206\u4eab\u5230"'+e.description+'"\u5931\u8d25\uff01'),i&&i(!1)})}function o(e,t,i){plus.share.sendWithSystem?plus.share.sendWithSystem(e,function(){t&&t(!0)},function(){t&&t(!1)}):t&&t(!1)}function s(e,t,i){if(!d)return void(t&&t(!1));if(e.href&&h.post("http://m3w.cn/sd/reg",{appid:plus.runtime.appid,deviceid:plus.storage.getItem("__DEVICE_ID")||plus.device.imei,wap:e.href,stream:"url="+encodeURIComponent(e.href)},function(t){t&&0===t.ret&&(e.href=t.surl)}),!c&&l.weixin&&p.shareWeixin()&&r.isWechatInstalled())plus.nativeUI.actionSheet({title:i||"\u5206\u4eab\u5230",cancel:"\u53d6\u6d88",buttons:[{title:"\u5fae\u4fe1\u6d88\u606f"},{title:"\u5fae\u4fe1\u670b\u53cb\u5708"},{title:"\u66f4\u591a\u5206\u4eab"}]},function(a){var s=a.index;switch(s){case 1:e.extra={scene:"WXSceneSession"},n("weixin",e,t);break;case 2:e.title=e.content,e.extra={scene:"WXSceneTimeline"},n("weixin",e,t);break;case 3:var r=e.href?"( "+e.href+" )":"";e.title=e.title+r,e.content=e.content+r,o(e,t,i)}});else{var a=e.href?"( "+e.href+" )":"";e.title=e.title+a,e.content=e.content+a,o(e,t)}}var r=i(6),h=i(9),p=i(14),l={},c=!1,d=!1,u=function(){var e=plus.runtime.innerVersion.split(".");c=e[e.length-1]<20133,c||plus.share.getServices(function(e){for(var t=0,i=e.length;i>t;t++){var n=e[t];l[n.id]=n}}),d=!0};e.exports={init:u,open:s,openSystem:o}},function(e,t,i){var n=i(6),a=i(7),o=i(9),s=i(17),r="__W2A_BIJIA_KEYWORD",h="__W2A_BIJIA_KEYWORD_TYPE",p="__W2A_BIJIA_KEYWORD_ARGS",l={"__W2A__m.taobao.com":{id:"__W2A__m.taobao.com",name:"\u6dd8\u5b9d",url:"https://ai.m.taobao.com/search.html?q={{keyword}}",menuFilter:function(e){return a.qihoobrowser&&"__W2A__m.jd.com"===e.id?!1:void 0},matchPathnames:function(e,t){return~["detail.m.tmall.com","detail.m.tmall.hk","detail.tmall.com","detail.tmall.hk"].indexOf(t.hostname)&&~["/item.htm","/hk/item.htm"].indexOf(e)?!0:"ai.m.taobao.com"==t.hostname&&"/search.html"==e?!0:~e.indexOf("/awp/core/detail.htm")||"item.taobao.com"==t.hostname&&"/item.htm"==~e?!0:~t.href.indexOf("h5.m.taobao.com/app/daojia/www/itemdetails/index.html")?!0:~e.indexOf("m/jusp/alone/detailwap/mtp.htm")?!0:!!~t.href.indexOf("1.ju.taobao.com/lucky/item.htm")},keyword:function(e,t){var i=t.hostname,n=/^\s+|\s+$/g,a=/\\u3010?.*?\\u3011/g,o=/detail\.m\.tmall/,s=/.*?\-/,r=document.querySelector('#J_Search input[type="search"]'),h=document.querySelector(".searchbar_wrap ul li label"),p=document.querySelector("#m-header .main .search"),l=document.querySelector(".trip-search-form .trip-search-input.ac-input");if(r&&r.value.replace(n,""))return{type:"search",keyword:r.value};if(h&&h.innerText.replace(n,""))return{type:"search",keyword:h.innerText};if(p&&p.innerText.replace(n,"")&&"\u641c\u7d22\u5929\u732b\u8d85\u5e02"!==p.innerText)return{type:"search",keyword:p.innerText};if(l&&l.value.replace(n,""))return{type:"search",keyword:l.value};var c="ai.m.taobao.com",d="/search.html";if(t.hostname===c&&e===d){var u=document.querySelector('.input-search input[type="search"]');if(u&&u.value)return{type:"search",keyword:u.value}}if(i.match(o)&&"/item.htm"===e){var w=document.querySelector("#s-title .main h1");if(w)return{type:"detail",keyword:w.innerText.replace(a,"")}}if(~t.href.indexOf("h5.m.taobao.com/awp/core/detail.htm")){var w=document.querySelector("#J_detail_main .dt-info .dtif-h,.title_share h1 span");if(w)return{type:"detail",keyword:w.innerText}}if(~t.href.indexOf("h5.m.taobao.com/app/daojia/www/itemdetails/index.html")){var w=document.querySelector("#J_ItemDetail .item-name");if(w)return{type:"detail",keyword:w.innerText.replace(s,"").replace(a,"")}}if(~t.href.indexOf("ju.taobao.com/m/jusp/alone/detailwap/mtp.htm")){
var w=document.querySelector("#J_itemInfo .item-info h1");if(w)return{type:"detail",keyword:w.innerText.replace(s,"").replace(a,"")}}if(~t.href.indexOf("1.ju.taobao.com/lucky/item.htm")){var w=document.querySelector("#J_Main_Page .good-info .good-name");if(w)return{type:"detail",keyword:w.innerText.replace(a,"").replace("\u5956\u54c1","")}}}},"__W2A__m.sjjd.com":{id:"__W2A__m.sjjd.com",name:"\u624b\u673a\u4eac\u4e1c",url:"http://so.m.jd.com/ware/search.action?&keyword={{keyword}}",menuFilter:function(e){return a.qihoobrowser&&"__W2A__m.taobao.com"===e.id?!1:void 0},matchPathnames:function(e,t){return!!(/\/products\/([0-9]+)-([0-9]+)-([0-9]+)\.html/.test(e)||~["/ware/search.action","/ware/view.action"].indexOf(e)||/^\/product\/[0-9]+\.html/.test(e))},keyword:function(e,t){if(/\/products\/([0-9]+)-([0-9]+)-([0-9]+)\.html/.test(e)||~["/ware/search.action"].indexOf(e)){var i=document.getElementById("layout_newkeyword");if(i)return{type:"search",keyword:i.value.replace(/(\u3010.*\u3011|\u4eac\u4e1c\u81ea\u8425|\u81ea\u8425|\u4eac\u4e1c\u8d85\u5e02|\u81ea\u8425\u6781\u901f\u8fbe|\u5305\u90ae\u5230\u5bb6)/g,"")}}else if(~["/ware/view.action"].indexOf(e)||/^\/product\/[0-9]+\.html/.test(e)){var i=document.querySelector(".title-text");if(i)return{type:"detail",keyword:i.innerText.replace(/(\u3010.*\u3011|\u4eac\u4e1c\u81ea\u8425|\u81ea\u8425|\u4eac\u4e1c\u8d85\u5e02|\u81ea\u8425\u6781\u901f\u8fbe|\u5305\u90ae\u5230\u5bb6)/g,"")}}}},H52588A9C:{id:"H52588A9C",name:"\u552f\u54c1\u4f1a",url:"",matchPathnames:function(e,t){return!!(-1!=e.indexOf("product-")&&-1==e.indexOf("size.html")||/classify-detail-.*/.test(e))},keyword:function(e,t){if(0===e.indexOf("/product-")||0===e.indexOf("/preheating-product-")){var i=document.querySelector("title");if(i){var n="";if("\u552f\u54c1\u4f1a\u624b\u673a\u7248"==i.innerText)n=document.querySelector(".product-name").innerText;else{n=i.innerText.replace(/(-\u552f\u54c1\u4f1a|- \u552f\u54c1\u4f1a|\u552f\u54c1\u4f1aVIP|VIP|\u552f\u54c1\u4f1a)/g,"").replace(/\[.*\]/g,"");var a=n.indexOf("\u4e13\u573a");if(~a){var o=n.substr(0,a),s=n.substr(a+2);n=~s.indexOf(o)?s:o+" "+s}}return{type:"detail",keyword:n}}}}},"__W2A__m.yhd.com":{id:"__W2A__m.yhd.com",name:"\u4e00\u53f7\u5e97",url:"http://search.m.yhd.com/search/k{{keyword}}",matchPathnames:function(e,t){var i=t.hostname,n="search.m.yhd.com",a=/search\/k.*/;if(i===n&&e.match(a))return!0;var o=/detail\/\d+$/;if(e.match(o))return!0;var s=/mingpin\/item/;if(e.match(s))return!0;var r=/item\/\d+/,h=/item\/[a-z]+\/[0-9]+/,p="/ad-dolphin-go/go";if(e.match(r)||e.match(h)||~e.indexOf(p))return!0;var l=/try\/free\/.*/,c=/try\/fee\/.*/;return e.match(l)||e.match(c)?!0:void 0},keyword:function(e,t){var i=/^\s+|\s+$/g,n="1\u53f7\u751f\u9c9c",a="\u81ea\u8425",o=/Item.*/,s=/\\u3010.*?\\u3011/,r=/[\(|\uff08].*?[\)|\uff09]/g;if(~e.indexOf("/search")){var h=document.querySelector("#searchForm .search_txt"),p=document.querySelector(".title li");if(h&&h.value.replace(i,""))return{type:"search",keyword:h.value};if(p)return{type:"search",keyword:p.innerText}}if(e.match(/detail\/[0-9]+$/)){var p=document.querySelector(".detail_info h2");if(p)return{type:"detail",keyword:p.innerText.replace(a,"").replace(s,"")}}if(e.match(/item\/[0-9]+/)||e.match(/item\/[a-z]+\/[0-9]+/)||~e.indexOf("/ad-dolphin-go/go")){var p=document.querySelector(".pd_product-title-box .pd_product-title,.title-box h2");if(p)return{type:"detail",keyword:p.innerText.replace(a,"").replace(o,"").replace(s,"").replace(r,"").replace(n,"")}}if(e.match(/mingpin\/item/)){var p=document.querySelector(".product-info .info");if(p)return{type:"detail",keyword:p.innerText.replace(a,"").replace(s,"")}}if(e.match(/try\/free\/.*/)){var p=document.querySelector(".title_box h2");if(p)return{type:"detail",keyword:p.innerText}}if(e.match(/try\/fee\/.*/)){var p=document.querySelector(".title_inner h2");if(p)return{type:"detail",keyword:p.innerText}}}},"__W2A__amazon.cn":{id:"__W2A__amazon.cn",name:"\u4e9a\u9a6c\u900a",url:"https://www.amazon.cn/gp/aw/s/ref=is_s_ss_i_0_1?k={{keyword}}",matchPathnames:function(e,t){return 0===e.indexOf("/gp/aw/d/")||0===e.indexOf("/gp/aw/s/")?!0:void 0},keyword:function(e,t){if(0===e.indexOf("/gp/aw/d/"))return{type:"detail",keyword:document.title};var i=document.getElementById("nav-search-keywords");return i?{type:"search",keyword:i.value}:(i=document.getElementById("searchKeyword"),i?{type:"search",keyword:i.value}:void 0)}},__W2A__H5F4563E8:{id:"__W2A__H5F4563E8",name:"\u8611\u83c7\u8857",webview:"search",url:"http://m.mogujie.com/wall/s?q={{keyword}}",urlFilter:function(e){return e.replace(/%20/g,"+")},matchPathnames:function(e,t){return!(0!==e.indexOf("/wall/s")&&0!==e.indexOf("/v8/meili/shopSearch")&&!/(\/x6\/detail\/)|(\/detail\/)|(\/rush\/seckill\/)/.test(e)&&0!==e.indexOf("/mgj-detail-modou-jiajiagou/index.html"))},keyword:function(e,t){if(0===e.indexOf("/wall/s")){var i=document.getElementById("J_search_keywords");if(i)return{type:"search",keyword:i.value};var n=document.getElementsByTagName("meta").keywords;if(n){var a=n.getAttribute("content");if(a)return{type:"search",keyword:a.split(",")[0]}}var o=document.title;return{type:"search",keyword:o.substring(o.indexOf("\u3010")+1,o.lastIndexOf("\u3011"))}}if(0===e.indexOf("/v8/meili/shopSearch")){var i=document.querySelector("#M_headBar .title");if(i)return{type:"search",keyword:i.innerText}}else{if(/(\/x6\/detail\/)|(\/detail\/)|(\/rush\/seckill\/)/.test(e)){var o=document.title;return o=o.substring(o.indexOf("\u3010")+1,o.lastIndexOf("\u3011")),o.indexOf("\u3011")&&(o=o.substring(o.indexOf("\u3011")+1)),o.indexOf("\u25cf")&&(o=o.substring(o.indexOf("\u25cf")+1)),o.indexOf("\uff09")&&(o=o.substring(o.indexOf("\uff09")+1)),o.indexOf("}")&&(o=o.substring(o.indexOf("}")+1)),{type:"detail",keyword:o}}if(0===e.indexOf("/mgj-detail-modou-jiajiagou/index.html")){var o=document.title;return o.indexOf("\u3011")&&(o=o.substring(o.indexOf("\u3011")+1)),{type:"detail",keyword:o}}}}},"__W2A__m.dangdang.com":{id:"__W2A__m.dangdang.com",name:"\u5f53\u5f53\u7f51",url:"http://search.m.dangdang.com/search.php?keyword={{keyword}}",urlFilter:function(e){return e.replace(/%20/g,"+")},matchPathnames:function(e,t){return!(0!==e.indexOf("/search.php")&&("product.m.dangdang.com"!=t.hostname||!/^\/\d+\.html/.test(e)&&"/mobile_cost.php"!=e&&"/product.php"!=e))},keyword:function(e,t){if(0===e.indexOf("/search.php")){var i=document.getElementById("j_keywords");if(i)return{type:"search",keyword:i.value.split(" ")[0]}}else if(/^\/\d+\.html/.test(e)||"/mobile_cost.php"==e||"/product.php"==e){var i=document.querySelector("article");if(i)return{type:"detail",keyword:i.innerText}}}}};if(a.qihoobrowser){var c=l["__W2A__m.sjjd.com"];c.id="__W2A__m.jd.com",l[c.id]=c,delete l["__W2A__m.sjjd.com"]}var d=!1,u=!0,w=[],v=function(e){return e&&(e=e.replace(/(\u6dd8\u5b9d|\u4eac\u4e1c|\u552f\u54c1\u4f1a|\u4e00\u53f7\u5e97|\u8611\u83c7\u8857|\u4e9a\u9a6c\u900a|\u5f53\u5f53)/g,""),e=e.replace(/[+`~!$%^*=|{}:;\\\/?<>\u2026\u2014\uff1c\uff1e\uff01\uff1b\uff1a\u201d\u201c\u3002\uff1f]+/g," ").replace(/^\s+|\s+$/g,"").replace(/\'/g,"\\u0027")),e},f=function(e){w=[];var t=plus.runtime.appid,i=l[t];if(i){for(var n in l)if(l.hasOwnProperty(n)){var a=l[n];if(a.url||n===t){var o=!0;i.menuFilter&&i.menuFilter(a)===!1&&(o=!1),o&&w.push({id:a.id,title:a.name,checked:n===t})}}plus.io.resolveLocalFileSystemURL("_documents/__wap2app_bijia_badge",function(t){u=!1,d=!0,e&&e()},function(t){u=!0,d=!0,e&&e()})}},b=function(e){e=e===!0;var t=plus.runtime.appid,i=s();if(i&&i.__wap2app_bijia){var n=i.__wap2app_bijia;if(n&&n.url){if(e){var a=l[t];plus.storage.setItem(p,n.keyword+"");var o=plus.webview.getWebviewById(t),h=n.url.replace(/\'/g,"\\u0027");a.urlFilter&&(h=a.urlFilter(h)),o.evalJS("window.wap2app&&wap2app.open('"+h+"','','',"+!!e+");"),setTimeout(function(){var e=plus.webview.getWebviewById(plus.runtime.appid),t=e.getURL();if(t&&0===t.indexOf(a.url.replace("{{keyword}}",""))){var i=wap2app.getW2AOptions();i&&i.homeWebviewOptions&&i.homeWebviewOptions.url&&e.evalJS('window.location.href="'+i.homeWebviewOptions.url+'"')}},500)}else n.keyword&&(plus.storage.setItem(p,n.keyword+""),plus.storage.setItem(r,n.keyword+""),y());k(3,n.appid,n.appname,n.url)}}},m=function(){return plus.storage.getItem(r)},g=function(){return plus.storage.getItem(h)},_=function(){var e=plus.runtime.appid,t=l[e];if(t&&"function"==typeof t.keyword){var i=t.keyword(window.location.pathname,window.location);if(i){var a="search";n.isObject(i)&&(a=i.type,i=i.keyword),i=v(i+"")}if(i)return plus.storage.setItem(r,i+""),plus.storage.setItem(h,a),i}return!1},y=function(){if(!d)return void f(function(){y()});var e=plus.runtime.appid;m();plus.nativeUI.showMenu&&plus.nativeUI.showMenu({title:"\u540c\u6b3e\u641c",badge:u,onclick:function(){u=!1,plus.io.requestFileSystem(plus.io.PUBLIC_DOCUMENTS,function(e){e.root.getFile("__wap2app_bijia_badge",{create:!0},function(){})}),k(1)}},w,function(t){var i=m(),n=g()||"search",a=l[t.target.id];if(a.id!==e){var o="",s=a.url,r={launch_path:""};s&&(o=s.replace("{{keyword}}",encodeURIComponent(i)),a.urlFilter&&(o=a.urlFilter(o))),o&&(r.launch_path=o),plus.stream.open({appid:a.id,splash:"default",extras:{__wap2app_bijia:{appid:e,appname:"",url:o,keyword:i,type:n}},styles:r},function(){},function(e){}),k(2,a.id,a.name,o)}})},W=function(){plus.nativeUI.hideMenu&&plus.nativeUI.hideMenu()},x=function(){var e=plus.runtime.appid,t=l[e];return t&&"function"==typeof t.matchPathnames?!!t.matchPathnames(window.location.pathname,window.location):!1},k=function(e,t,i,n,a){var s={appid:plus.runtime.appid,imei:plus.storage.getItem("__DEVICE_ID")||plus.device.imei||plus.device.uuid,p:"iOS"===plus.os.name?"i":"a",os:plus.os.version,md:plus.device.model,net:plus.networkinfo.getCurrentType(),vb:plus.runtime.innerVersion,vd:plus.device.vendor,av:plus.runtime.version,url:n||"",type:e,check_appid:t||"",check_appname:i||""};o.post("https://stream.dcloud.net.cn/price/check/log",s,a)},T=function(){return l[plus.runtime.appid]};e.exports={init:f,bijia:b,support:x,showMenu:y,hideMenu:W,getConfig:T,getKeyword:m,initKeyword:_}},function(e,t){var i=/\+/g,n=/([^&=]+)=?([^&]*)/g,a=function(e){var t={};if(e=e&&(0===e.indexOf("?")?e.replace("?",""):e))for(var i;i=n.exec(e);)t[o(i[1])]=o(i[2]);return t},o=function(e){return decodeURIComponent(e.replace(i," "))},s=function(e){var t=e||plus.runtime.arguments;if(t&&"string"==typeof t){if(0===t.indexOf("//"))t=t.split("//"),t=t.length>1?t[1]:"";else if(t){try{var i=JSON.parse(t);i&&(t=i)}catch(n){}"string"==typeof t&&(t=a(t),t.arg&&(t=decodeURIComponent(t.arg)))}return"string"==typeof t&&(t=a(t)),t}return{}};e.exports=s},function(e,t,i){var n=i(6),a=i(9),o=function(e,t){e=n.extend({appid:plus.runtime.appid,p:"iOS"===plus.os.name?"i":"a",os:plus.os.version,vb:plus.runtime.innerVersion,net:plus.networkinfo.getCurrentType(),vd:plus.device.vendor,md:plus.device.model,app_version:plus.runtime.version,channel:plus.runtime.channel||"",startfrom:plus.runtime.launcher,device_info:plus.storage.getItem("__DEVICE_ID")||plus.device.imei||plus.device.uuid,user_id:"",mobile:"",order_id:"",order_title:"",order_detail:"",order_status:"",goods_count:"",order_fee:"",pay_channel:"",delivery_address:"",order_time:"",optional:""},e),a.post("https://stream.dcloud.net.cn/collect/order",e,t)};o.pay_channel={ALI_APP:"ALI_APP",ALI_WAP:"ALI_WAP",WX_APP:"WX_APP",WX_JSAPI:"WX_JSAPI",UN_APP:"UN_APP",UN_WEB:"UN_WEB",CASH:"CASH",OTHERS:"OTHERS"},o.order_status={PENDING:1,PAID:2,REFUNDED:3,END:4,CANCELED_BYBUYER:11,CANCELED_BYSELLER:12},e.exports=o},function(e,t,i){var n=i(6),a={container:"position: fixed;bottom: 65px;left:50%;-webkit-transform:translate(-50%,0);transform:translate(-50%,0);z-index: 2147483647;opacity: 0;-webkit-transition: opacity .3s;transition: opacity .3s;line-height:{LINE-HEIGHT}px",message:"padding: 18px 27px;color: #fff;text-align: center;background-color: #000;border-radius: 4px;font-size:{FONT-SIZE}px"},o={"long":3500,"short":2e3},s=17,r=14,h=function(e,t){t=n.extend({duration:"short"},t||{});var i=document.createElement("div");i.className="W2A-TOAST W2A-TOAST-QUIT";var h=1,p=document.documentElement.querySelector('meta[name="viewport"]');if(p){var l=p.getAttribute("content").match(/initial\-scale=([\d\.]+)/);l&&(h=parseInt(1/parseFloat(l[1])))}i.setAttribute("style",a.container.replace("{LINE-HEIGHT}",s*h)),i.innerHTML='<div style="'+a.message.replace("{FONT-SIZE}",r*h)+'">'+e+"</div>",i.addEventListener("webkitTransitionEnd",function(){i.parentNode.removeChild(i),i=null}),document.body.appendChild(i),i.addEventListener("click",function(){i.parentNode.removeChild(i),i=null}),i.style.opacity=.8,i.offsetHeight;var c=o["short"];return c="number"==typeof t.duration?t.duration:o[t.duration],c||(c=o["short"]),setTimeout(function(){i&&(i.style.opacity=0,i.offsetHeight)},c),{isVisible:function(){return!!i}}};e.exports=h},function(e,t,i){var n=i(6),a=i(9),o=function(e,t,i,o,s){if(n.isDev());else{if(s=s||1,Math.random()>s)return;var r={appid:plus.runtime.appid,app_version:plus.runtime.version,type:e||5,url:t||"",webview_id:i||"",message:o||"",p:"iOS"===plus.os.name?"i":"a",os:plus.os.version,imei:plus.storage.getItem("__DEVICE_ID")||plus.device.imei,md:plus.device.model,net:plus.networkinfo.getCurrentType(),plus_version:plus.runtime.innerVersion,w2a_version:wap2app.version};a.post("https://stream.dcloud.net.cn/wap2app/monitor",r)}};e.exports={css:function(e,t,i,n){o(1,e,t,i,n)},dom:function(e,t,i,n){o(2,e,t,i,n)},pathname:function(e,t,i,n){o(3,e,t,i,n)},sms:function(e,t,i,n){o(4,e,t,i,n)},other:function(e,t,i,n){o(5,e,t,i,n)}}},function(e,t,i){var n,a,o,s,r=i(7),h=function(){r.android&&(n=plus.android.runtimeMainActivity(),a=plus.android.importClass("android.content.Intent"),o=plus.android.importClass("android.provider.Settings"),s=plus.android.importClass("android.net.Uri"))};e.exports={openLocationSource:function(){n||h(),n&&n.startActivity(new a(o.ACTION_LOCATION_SOURCE_SETTINGS))},openApplicationDetail:function(){n||h(),n&&n.startActivity(new a(o.ACTION_APPLICATION_DETAILS_SETTINGS,s.parse("package:"+n.getPackageName())))},openAirPlaneModeSetting:function(){n||h(),n&&n.startActivity(new a(o.ACTION_AIRPLANE_MODE_SETTINGS))}}},function(e,t){var i=function(e,t,i,n){n=n||1;var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3);var o="expires="+a.toUTCString();plus.navigator.setCookie(e,t+"="+i+"; "+o)},n=function(e,t){var i=t+"=",n=plus.navigator.getCookie(e);if(n){n=n.split(";");for(var a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(i))return o.substring(i.length,o.length)}}return""},a=function(e,t){i(e,t,"",-1)};e.exports={set:i,get:n,remove:a}},function(e,t,i){var n=i(13),a="."+n.W2A_IFRAME_CLASS+"."+n.W2A_ACTIVE_CLASS,o=function(e){var t=e.id,i=e.styles||n.W2A_IFRAME_STYLES,a=e.html,o=document.getElementById(t);if(!o){o=document.createElement("iframe"),o.id=t,o.allowtransparency="true",o.setAttribute("style",i),document.body.appendChild(o);var s=o.contentWindow.document;s.designMode="on",s.open(),s.write(a),s.close(),s.designMode="off"}return o},s=function(e){return e?document.querySelector("#"+e+a):document.querySelector(a)},r=function(e){var t=document.getElementById(e);return t&&!~t.className.indexOf(n.W2A_ACTIVE_CLASS)?(t.className=n.W2A_IFRAME_CLASS+" "+n.W2A_ACTIVE_CLASS,t.style.webkitTransform="translate(0,0)",!0):!1},h=function(e){var t=s(e);return t?(t.className=n.W2A_IFRAME_CLASS,t.style.webkitTransform="translate(0,-100%)",!0):!1};e.exports={init:o,open:r,close:h,isVisible:s}},function(e,t,i){var n=i(23),a={},o=function(e){a[e.id]=e.callback;var t=n.init(e);return s(t.contentWindow.document),t},s=function(e){e.addEventListener("touchmove",function(e){e.preventDefault()}),e.addEventListener("click",function(e){for(var t=e.target;t&&t!=document;t=t.parentNode){var i=t.className;if("string"==typeof i){if(~i.indexOf("mui-confirm-inner"))break;if(~i.indexOf("mui-confirm ")){p(-2);break}if(~i.indexOf("mui-confirm-btn")){p(Array.prototype.slice.call(t.parentNode.children).indexOf(t));break}}}})},r=function(e){return n.isVisible(e)},h=function(e){return n.open(e)},p=function(e,t){var i=r(t);if(i){var o=a[i.id];if(o){var s=i.contentWindow.document.querySelector('input[type="checkbox"]');if(o({index:e,checked:s?s.checked:void 0})===!1)return!1}return n.close(t),!0}return!1};e.exports={init:o,open:h,close:p,isVisible:r}},function(e,t,i){var n=i(6),a=function(e){e=JSON.parse(e);for(var t=[],i=e.urls,n=e.w||0,a=e.h||0,o=0,s=i.length;s>o;o++)t.push({src:i[o],w:n,h:a});var r=new PhotoSwipe(document.querySelector(".pswp"),PhotoSwipeUI_Default,t,e);0!==n&&0!==a||r.listen("gettingData",function(e,t){if(!t.loading&&(t.w<1||t.h<1)){t.loading=!0;var i=new Image;i.onload=function(){t.w=this.width,t.h=this.height,r.invalidateCurrItems(),r.updateSize(!0),t.loading=!1},i.src=t.src}}),r.listen("close",function(){plus.webview.currentWebview().close("auto")}),r.init()},o="__W2A_SWIPER",s=function(e){e=n.extend({index:0,pinchToClose:!1,closeOnScroll:!1,showWaiting:{title:"",options:{modal:!1,back:"transmit",padlock:!0}}},e),e.history=!1;var t=plus.webview.getWebviewById(o);t?(t.show("fade-in",200),t.evalJS("("+Function.prototype.toString.call(a)+")('"+JSON.stringify(e)+"')")):(plus.nativeUI.showWaiting(e.showWaiting.title,e.showWaiting.options),t=plus.webview.create("_www/"+(e.url||"__wap2appswiper.html"),o,{background:"transparent",hardwareAccelerated:!0,scrollIndicator:"none"}),t.addEventListener("titleUpdate",function(){t.show("fade-in",200)}),t.addEventListener("loaded",function(){plus.nativeUI.closeWaiting(),t.evalJS("("+Function.prototype.toString.call(a)+")('"+JSON.stringify(e)+"')")}))};e.exports=s},function(e,t,i){var n=i(6),a=i(7),o=i(14),s=i(13),r=function(e,t,i){this.id=e,this.options=t,this.extras=i,this.headOptions=t.head,this.bodyOptions=t.body,this.tabbarOptions=t.tabbar,this.winWidth=a.ios?plus.screen.resolutionWidth:window.innerWidth,this.winHeight=a.ios?plus.screen.resolutionHeight-61:plus.screen.resolutionHeight-plus.navigator.getStatusbarHeight(),this.borderHeight=1/plus.screen.scale,this.headOptions&&(this.hasHead=this.headOptions.height||this.headOptions.draws.length,this.hasDock=""!==this.headOptions.dock,this.hasBack=this.headOptions.back,this.hasShare=this.headOptions.share),this.hasTabbar=this.tabbarOptions&&this.tabbarOptions.list.length,this.hasScreenshot=this.bodyOptions&&~this.bodyOptions.background.indexOf(".html"),this.headDraws=[],this.bodyDraws=[],this.tabbarDraws=[],this.hasTabbar&&(this.selected=this.tabbarOptions.selected),(this.hasHead||this.hasScreenshot||this.hasTabbar||this.options.draws.length)&&this._init()},h=r.prototype;h.addEventListener=function(e,t){switch(e){case"back":this.backClickCallback=t;break;case"share":this.shareClickCallback=t;break;case"home":this.homeClickCallback=t;break;case"switchTab":this.switchTabClickCallback=t}},h.getView=function(){return this.view},h.getDockView=function(){return this.dockNView},h.getDraws=function(){return{head:this.headDraws,body:this.bodyDraws,tabbar:this.tabbarDraws}},h.setTitle=function(e){if(e&&this.view&&this.hasHead){var t=this.headOptions,i={top:0,left:0,width:t.width,height:t.height},n={size:t.fontSize,color:t.color},a=this.id+"_head_title";this.view.drawText(e,i,n,a),this.dockNView&&this.dockNView.drawText(e,i,n,a)}},h.switchTab=function(e){this.view&&this.hasTabbar},h.animate=function(e,t){if(!this.view)return void(t&&t(!1));var i=0,n=0,a=this.winHeight;e.top?i=parseInt(e.top):this.hasHead&&(i=parseInt(this.headOptions.height)),a-=i,e.bottom?n=parseInt(e.bottom):this.hasTabbar&&(n=parseInt(this.tabbarOptions.height)),a-=n,this.hasTabbar&&this.view.setTouchEventRect({top:a+i,left:0,width:"100%",height:n}),this.view.clearRect({top:i,left:0,width:"100%",height:a}),t&&t(!0)},h.close=function(){this.view&&this.view.close(),this.view=null},h._init=function(){this._create(),this._initEvent()},h._create=function(){this.options.draws.length?this.draws=this.options.draws:(this._createBodyDraws(),this.hasTabbar&&this._createTabbarDraws(),this._createHeadDraws(),this.hasDock&&!this.hasTabbar&&this._createDockNView(),this._concat()),this.draws.length&&(this.view=new plus.nativeObj.View(this.id,{},this.draws))},h._concat=function(){this.draws=this.bodyDraws.concat(this.tabbarDraws,this.headDraws)},h._initEvent=function(){this.view&&(this.view.interceptTouchEvent(!0),this.view.addEventListener("click",function(e){var t=e.clientX,i=e.clientY;if(this.hasBack&&this._isCross(t,i,{top:0,left:0,width:60,height:60}))this.backClickCallback&&this.backClickCallback();else if(this.hasTabbar)for(var n=0;n<this.tabItemRects.length;n++)if(this._isCross(t,i,this.tabItemRects[n])){var a=this._createTabSelectedItemDraws(n);a&&this.view.draw(a),this.switchTabClickCallback&&this.switchTabClickCallback(this.tabbarOptions.list[n],n);break}}.bind(this)))},h._createDockNView=function(){if(this.headDraws.length){var e="absolute",t="";this.headOptions.dock&&(e="dock",t="top"),this.dockNView=new plus.nativeObj.View(this.id+"_dock",{top:0,left:0,width:this.headOptions.width,height:this.headOptions.height,position:e,dock:t},this.headDraws),this.dockNView.addEventListener("click",function(e){var t=e.clientX,i=e.clientY;this.hasBack&&this._isCross(t,i,{top:0,left:0,width:60,height:60})&&this.backClickCallback&&this.backClickCallback()}.bind(this))}},h._isCross=function(e,t,i){return e>i.left&&e<i.left+i.width&&t>i.top&&t<i.top+i.height},h._createTabbarDraws=function(){var e=this.tabbarOptions,t=e.list,i=t.length;this.tabItemWidth=this.winWidth/i,this.tabIconWidth=parseInt(e.iconWidth),this.tabIconHeight=parseInt(e.iconHeight),this.tabIconMarginLeft=(this.tabItemWidth-this.tabIconWidth)/2,this.tabItemHeight=parseInt(e.height),this.tabItemLineHeight=parseInt(e.lineHeight),this.tabItemRects=[],t[0].text||(this.tabItemLineHeight=0),t[0].iconPath||(this.tabIconHeight=0),this.tabItemTop=this.winHeight-this.tabItemHeight,"top"===e.position&&(this.hasHead?this.tabItemTop=parseInt(this.headOptions.height):this.tabItemTop=0);for(var n=0;i>n;n++)this.tabItemRects.push({top:this.tabItemTop,left:n*this.tabItemWidth,width:this.tabItemWidth,height:this.tabItemHeight});if(this.tabbarDraws.push({id:this.id+"_tabbar_bg",tag:"rect",color:e.backgroundColor,position:{top:this.tabItemTop,left:0,width:"100%",height:e.height}}),e.borderColor){var a=this.tabItemTop;"top"===e.position&&(a=this.tabItemTop+this.tabItemHeight-this.borderHeight),this.tabbarDraws.push({id:this.id+"_tabbar_border",tag:"rect",color:e.borderColor,position:{top:a,left:0,width:"100%",height:this.borderHeight+"px"}})}for(var n=0;i>n;n++)this._createTabItemDraws(this.tabbarDraws,n)},h._createTabSelectedItemDraws=function(e){if(this.selected===e)return!1;var t=[],i=this.selected;return this.selected=e,this._createTabItemDraws(t,i),this._createTabItemDraws(t,this.selected),t},h._createTabItemDraws=function(e,t){var i=this.tabbarOptions;if(i.draws.length)return void(this.tabbarDraws=i.draws);var n=i.list[t],a=i.color,o=n.iconPath;this.selected===t&&(a=i.selectedColor,o=n.selectedIconPath,o||"#ffffff"!==a||"#ffffff"!==i.backgroundColor||(a="#f23030"));var s=this._getTabItemPosition.call(this,t,n);o&&e.push({id:this.id+"_tabbar_item_icon_"+t,tag:"img",position:s.icon,src:this._handlePath(o)}),n.text&&e.push({id:this.id+"_tabbar_item_text_"+t,tag:"font",position:s.text,text:n.text,textStyles:{size:i.fontSize,color:a}})},h._getTabItemPosition=function(e,t){var i=this.tabItemTop+(this.tabItemHeight-this.tabIconHeight-this.tabItemLineHeight)/2,n={};return t.text&&(n.text={top:i+this.tabIconHeight,left:this.tabItemWidth*e,width:this.tabItemWidth,height:this.tabItemLineHeight}),t.iconPath&&(n.icon={top:i,left:this.tabItemWidth*e+this.tabIconMarginLeft,width:this.tabIconWidth,height:this.tabIconHeight}),n},h._createBodyDraws=function(){var e=this.bodyOptions;if(e.draws.length)return void(this.bodyDraws=e.draws);if(this.hasScreenshot){var t=s.SCREENSHOT_PATH+plus.runtime.appid+"/"+encodeURIComponent(e.background)+".png";if(a.android&&o.titlebar()&&plus.nativeUI.isTitlebarVisible()){var i=e.crop,r=n.getScreen(),h={top:0,height:r.availHeight-i},p={top:r.height-i,height:i},l={top:r.availHeight-i,height:i};this.bodyDraws.push({id:this.id+"_body_bg_top",tag:"img",src:this._handlePath(t),position:h,sprite:h}),this.bodyDraws.push({id:this.id+"_body_bg_top",tag:"img",src:this._handlePath(t),position:l,sprite:p})}else this.bodyDraws.push({id:this.id+"_body_bg",tag:"img",src:this._handlePath(t)})}else this.bodyDraws.push({id:this.id+"_body_bg",tag:"rect",color:e.background,position:{top:0,left:0,width:"100%",height:"100%"}});if(e.waiting.src){var c=parseInt(e.waiting.width),d=parseInt(e.waiting.height);this.bodyDraws.push({id:this.id+"_body_waiting",tag:"img",position:{top:(this.winHeight-c)/2,left:(this.winWidth-d)/2,width:c,height:d},src:this._handlePath(e.waiting.src)})}},h._createHeadDraws=function(){var e=this.headOptions;if(e.draws.length)return void(this.headDraws=e.draws);var t=parseInt(e.height);if(t)if(this.hasScreenshot){var i=s.SCREENSHOT_PATH+plus.runtime.appid+"/"+encodeURIComponent(this.bodyOptions.background+"_header")+".png";this.headDraws.push({id:this.id+"_head_bg",tag:"img",src:this._handlePath(i),position:{top:0,left:0,width:e.width,height:t}})}else{if(this.headDraws.push({id:this.id+"_head_bg",tag:"rect",color:e.backgroundColor,position:{top:0,left:0,width:e.width,height:t}}),this.headDraws.push({id:this.id+"_head_border",tag:"rect",color:e.borderColor,position:{top:t-this.borderHeight,left:0,width:e.width,height:this.borderHeight+"px"}}),!e.title.titleUpdate&&"function"==typeof e.title.handle){var a=e.title.handle(this.extras.location.pathname,this.extras.location);a&&this.headDraws.push({id:this.id+"_head_title",tag:"font",position:{top:0,left:0,width:e.width,height:t},text:a,textStyles:{size:e.fontSize,color:e.color}})}if(e.back){var o={id:this.id+"_head_back",tag:"font",position:{top:0,left:0,width:t,height:t},text:"\ue601",textStyles:{size:"27px",color:e.color,fontSrc:e.iconfont}};n.isObject(e.back)&&(o=n.extend(o,e.back),"img"===o.tag&&(o.src=this._handlePath(o.src))),this.headDraws.push(o)}if(e.share){var r=this.winWidth;r=~e.width.indexOf("%")?this.winWidth*parseInt(e.width)/100:parseInt(e.width);var h={id:this.id+"_head_share",tag:"font",position:{top:0,left:r-t,width:t,height:t},text:"\ue602",textStyles:{size:"27px",color:e.color,fontSrc:e.iconfont}};n.isObject(e.share)&&(h=n.extend(h,e.share)),"img"===h.tag&&(h.src=this._handlePath(h.src)),this.headDraws.push(h)}}},h._handlePath=function(e){return 0===e.indexOf("_www")?e:"_www/"+e},e.exports=r},function(e,t,i){var n=i(6),a=i(11),o=i(10),s=i(20),r=i(16),h=i(13),p=i(14),l=i(25),c=function(e){this._init(e)},d=c.prototype;d._init=function(e){this.webview=!1,this.options=e,this._initWebview(),this._initShortcut(),this._initPreviewImage(),this._initData()},d._initWebview=function(){var e=this.options;if(n.plusReady(function(){this.webview=plus.webview.currentWebview(),this.w2aContextWebview=plus.webview.getWebviewById(h.W2A_CONTEXT_ID);var e=this.webview.__wap2app_opener_id;this.opener=e?plus.webview.getWebviewById(e):!1,this.opener&&(document.referrer=this.opener.getURL()),this.isBrowser=this.webview.id===h.W2A_BROWSER_CHILD_ID,this._initBijia(),a.ready(function(){this._initReport(),this._handleShow(),this._handleBack(),this._handleReport()}.bind(this))}.bind(this)),e.injectStyle){var t=e.injectStyle;"function"==typeof e.injectStyle&&(t=e.injectStyle(window.location.pathname,window.location)),t&&a.ready(function(){var e=document.createElement("style");e.appendChild(document.createTextNode(t)),document.head.appendChild(e)})}if(e.injectScript)try{"function"==typeof e.injectScript&&e.injectScript()}catch(i){console.error(i)}setTimeout(function(){a.ready(function(){e.group&&e.group.activate&&(e.group.tabbar&&e.group.tabbar.list&&e.group.tabbar.list.length&&p.nativeViewDraws()||setTimeout(function(){this._handleGroupActivate(e.group.activate,e.group)}.bind(this),e.group.delay||0)),this.fixed(this.options.fixed)}.bind(this))}.bind(this),200)},d.openShare=function(){if(this.options.share){var e=!1;"function"==typeof this.options.share?e=this.options.share():n.isObject(this.options.share)&&(e=this.options.share),e&&wap2app.openShare(e)}},d.bijia=function(){if(p.bijia()){var e=this.webview.isVisible(),t=plus.webview.getTopWebview();if(!r.support()){var i=!1;return e?t&&t.id===this.webview.id&&(i=!0):i=!0,void(i&&this.w2aContextWebview&&this.w2aContextWebview.evalJS("window.wap2app&&wap2app.bijia.hideMenu();"))}var n=!1;e?t&&t.id===this.webview.id&&(n=!0):n=!0,n&&(this.w2aContextWebview&&this.w2aContextWebview.evalJS("window.wap2app&&wap2app.bijia.showMenu();"),a.ready(function(){var e=0,t=setInterval(function(){e++,r.initKeyword()?clearInterval(t):e>10&&clearInterval(t)}.bind(this),300)}.bind(this)))}},d._initBijia=function(){(this.webview.id!==plus.runtime.appid||plus.runtime.arguments)&&this.bijia()},d._initReport=function(){var e=window.location.href,t=this.webview.id;this.report={dom:function(i,n){s.dom(e,t,i,n)},css:function(i,n){s.css(e,t,i,n)},pathname:function(i,n){s.pathname(e,t,i,n)},sms:function(i,n){s.sms(e,t,i,n)},other:function(i,n){s.other(e,t,i,n)}}},d._handleReport=function(){a.ready(function(){setTimeout(function(){this._checkHead()}.bind(this),3e3)}.bind(this))},d._initData=function(){if(p.subNView()){var e=this.options.data;if(e){n.isObject(e)&&(e=[e]);for(var t=0;t<e.length;t++)this._initDataHandle(e[t])}}},d._initDataHandle=function(e){var t=e.targetWebviewId;window.addEventListener(e.eventType,function(i){var n=i.target,a=[].slice.call(document.querySelectorAll(e.container));if(a&&a.length)for(;n&&n!==document;n=n.parentNode)if(~a.indexOf(n)){for(var o={},s=0;s<e.items.length;s++){var r=e.items[s],h=n.querySelector(r.selector),p="";h&&(p="IMG"===h.tagName?h.src:h.innerText,"function"==typeof r.value&&(p=r.value(p,h,n))),o[r.tagId]=p}plus.storage.setItem(t,JSON.stringify(o));break}}.bind(this),!0)},d._initPreviewImage=function(){var e=this.options.previewImage;if(e){var t=e.selector;t&&window.addEventListener(e.eventType,function(i){var a=i.target;if("function"==typeof t)for(;a&&a!==document;a=a.parentNode){var o=t(i.target);if(n.isObject(o)){var s=n.extend({showWaiting:this.options.showWaiting},e.options);l(n.extend(s,{url:e.url,index:o.index,urls:o.urls,w:o.w,h:o.h})),i.stopPropagation(),i.preventDefault();break}}else if("string"==typeof t){for(var r=Array.prototype.slice.call(document.querySelectorAll(t)),h=[],p=0,c=r.length;c>p;p++)h.push(r[p].src);for(;a&&a!==document;a=a.parentNode){var d=r.indexOf(a);if(~d){var u=a.naturalWidth,w=a.naturalHeight,s=n.extend({showWaiting:this.options.showWaiting},e.options);l(n.extend(s,{url:e.url,index:d,urls:h,w:u,h:w})),i.stopPropagation(),i.preventDefault();break}}}}.bind(this),!0)}},d._initShortcut=function(){this.options.isHome&&wap2app.shortcutConfig&&this.webview.appendJsFile("_www/__shortcut.js")},d._handleShow=function(){if("plusready"===this.options.show.eventType){n.now();a.ready(function(){}.bind(this))}},d._handleGroupReport=function(e,t,i,o){if(this.isReport()&&this.options.report["tab-changed"]&&t){for(var s=e.querySelectorAll("*"),r=[],h=wap2app.getW2AOptions(),p=0,l=s.length;l>p;p++){var c=s[p];if(a.elementMatch(c,t)){var d=c;if("A"!==c.tagName&&(d=c.querySelector("a")),d){var u="";o&&(u=d.getAttribute(o)),u||(u=d.href);var w=a.getLocation(u);if(i&&n.isMatch(w,{pathname:i}))continue;var v=h.getWebviewOptionsByUrl(u);v.group||r.push(u)}}}r.length&&this.options.report["tab-changed"]&&this.report.pathname(this.options.report["tab-changed"].replace("{url}",JSON.stringify(r)))}},d._handleGroupActivate=function(e,t){if(e&&n.isObject(e)&&e.container&&e.itemMatch&&(e.itemActiveClass||e.activate)){var i=document.querySelector(e.container);if(i){for(var o=e.activate,s=e.deactivate,r=e.itemMatch,h=e.attribute,p="",l=e.itemActiveClass||"",c=e.itemActiveClass.split(" "),d=t.report.ignore,u=0;u<c.length;u++)p+="."+c[u].replace(/\s+/g,"");
var w=this;setTimeout(function(){w._handleGroupReport(i,r,d,h)},1e3),o||(o=function(e){for(var t=e;t&&t!==i;t=t.parentNode)if(a.elementMatch(t,r)){var n=t.className;n=n.replace(l,""),t.className=n+" "+l,t.offsetHeight;break}}),s||(s=function(e){for(var t=e;t&&t!==i;t=t.parentNode)if(a.elementMatch(t,r)){t.className=t.className.replace(new RegExp("\\b("+l+")\\b","g"),"").replace(/^\s+|\s+$/g,""),t.offsetHeight;break}});var v=i.querySelector(p);i.addEventListener("click",function(e){for(var t=e.target;t&&t!==document;t=t.parentNode)if("A"===t.tagName){var i="";if(h&&(i=t.getAttribute(h)),i||(i=t.href),i){var n=a.getLocation(i);if(~["http:","https:"].indexOf(n.protocol)){i=n.href,e.preventDefault(),e.stopPropagation(),s(v),o(t);wap2app.$$group_reset=function(){setTimeout(function(){s(t),o(v)},100)};var r=function(e){setTimeout(function(){wap2app.open(e)},150)};window.requestAnimationFrame?window.requestAnimationFrame(function(){r(i)}):r(i);break}}}}.bind(this),!0)}}},d.fixed=function(e){n.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[t];if(n.isObject(i)&&i.selector){var o=document.querySelector(i.selector);if(o){var s=a.getStyles(o,"position");if("fixed"!==s){var r=i.styles;if(r)for(var h in r)r.hasOwnProperty(h)&&(o.style[h]=r[h]);o.style.position="fixed";var p=document.createElement("div");p.className="__wap2app_fixed_placeholder",p.setAttribute("style","height:"+(r.height||o.offsetHeight+"px")+";width:100%;"),o.parentNode.insertBefore(p,o)}}}}},d._handleBack=function(){this.options.back.enable&&(this._overrideHistory(),this._handleBackClick(),this.opener&&plus.storage.removeItem(h.W2A_WEBVIEW_LOADING+this.opener.id))},d._handleBackClick=function(){var e=this.options,t=e.back,i=t.selector;if(i){var n=this,a=function(e){var t=document.querySelectorAll(i);if(t&&t.length)for(var n=e.target;n&&n!==document;n=n.parentNode)for(var a=0,o=t.length;o>a;a++)if(n===t[a])return n;return!1},o=function(i){var o=a(i);o&&(o.__w2a_fastclick&&(o.__w2a_fastclick=!1,o.className=o.className.replace(" "+e.fastclick.className,"")),t.eventType===i.type&&n.back(),i.preventDefault(),i.stopPropagation())};window.addEventListener(t.eventType,o,!0),"click"!==t.eventType&&window.addEventListener("click",o,!0),e.fastclick&&window.addEventListener("touchstart",function(t){var i=a(t);i&&(i.__w2a_fastclick=!0,i.className=i.className+" "+e.fastclick.className)},!0)}},d._overrideHistory=function(){if(this.options.back.override){var e=this,t=function(t){return function(i){location.hash?t.apply(window.history,[i]):e.back()}};window.history.back=t(window.history.back),window.history.go=t(window.history.go)}},d._handleMaskClose=function(e,t,i,n,o){"string"==typeof n&&(n=[n]);for(var s=0;s<n.length;s++)wap2app.trigger(i,n[s]);return o===!1?!0:t!==a.elementFromPoint(e[0],e[1])},d.isReport=function(){return~["http:","https:"].indexOf(window.location.protocol)},d._checkHead=function(){if(!this.options.quit&&this.isReport()){var e=this.options;if(e.report["no-head"]||e.report["double-head"]||e.report["download-tips"]){var t=!1,i=!1;this.isBrowser?(t=!0,i=e.dock):e.screenshot&&e.screenshot.url&&n.isObject(e.screenshot.view)&&e.screenshot.view.enable&&(t=!0,i="dock"===e.screenshot.view.styles.position);var o=a.detectHead(e.head);o?"boolean"!=typeof o&&(t&&i&&e.report["double-head"]&&(this.report.dom(e.report["double-head"]),wap2app.fallback.changeDock(!1)),e.report["download-tips"]&&a.detectDownloadTips(o)&&this.report.dom(e.report["download-tips"])):(t&&!i&&e.report["no-head-dock"]&&(this.report.dom(e.report["no-head-dock"]),wap2app.fallback.changeDock(!0)),!t&&e.report["no-head"]&&this.report.dom(e.report["no-head"]))}}},d._handleMask=function(){var e=this.options.back.mask;if(e){var t=window.innerWidth-1,i=window.innerHeight-1,n=e.offset,o=n.x,s=n.y,r=[[o,s],[t-o,s],[o,i-s],[t-o,i-s]],h=e.handle;"function"!=typeof h&&(h=!1);for(var p=function(e,t){return e.getPropertyValue(t)||e[t]},l=!1,c="",d=0;4>d;d++){var u=r[d],w=a.elementFromPoint(u[0],u[1]);if(w){var v=h&&h(w);if(v){if(l=!0,"boolean"==typeof v)return!1;if("object"==typeof v)if(v.eventType&&v.element){if(this._handleMaskClose(u,w,v.element,v.eventType,!1))return!1}else if(this._handleMaskClose(u,w,v,e.eventType,!1))return!1}var f=w.offsetWidth,b=w.offsetHeight,t=window.innerWidth-2*o,i=window.innerHeight-2*s;if(f>0&&b>0&&f>=t&&b>=i){var m=a.getStyles(w),g=p(m,"opacity");if(1>g&&g>0&&(l=!0,this._handleMaskClose(u,w,w,e.eventType)))return!1;var _=a.getRGBA(p(m,"backgroundColor"));if(_){var y=parseFloat(_[3]);if(1>y&&y>0&&(l=!0,this._handleMaskClose(u,w,w,e.eventType)))return!1}l&&(c=w.id||w.className)}}}return this.isReport()&&l&&this.options.report.mask&&this.report.dom(this.options.report.mask.replace("{mask}",c)),!0}},d._handleBeforeBack=function(e){if(e&&(("function"==typeof e||n.isObject(e))&&(e=[e]),n.isArray(e)&&e.length))for(var t=0;t<e.length;t++){var i=e[t];if("function"==typeof i&&i(window.location.pathname,window.location)===!1)return!1;if(n.isObject(i))for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];"string"==typeof s&&(s={selector:s,eventType:"click"});var r=document.querySelectorAll(o);if(r&&r.length)for(var h=0;h<r.length;h++){var p=r[h];if(p&&a.isVisible(p)){var l=!1;if(l=s.selector?s.selector.substr(0,o.length)===o?p.querySelector(s.selector):document.querySelector(s.selector):p)return wap2app.trigger(l,s.eventType),!1}}}}return!0},d.open=function(e){wap2app.open(e)},d.back=function(){var e=this.options,t=e.back,i=this._handleMask();if(i!==!1&&(i=this._handleBeforeBack(t.beforeBack)),i!==!1){var a=e.show,s=a.aniShow||"pop-in",r=a.duration||300;s=~s.indexOf("in")?s.replace("in","out"):s.replace("out","in");var p=e.parent&&"browser"!==e.parent?this.webview.parent():this.webview,l=t.history,c=!0;"boolean"==typeof l?c=l:l&&(c=n.isMatch(window.location,{matchPathnames:l}));var d=!1;if("function"==typeof t.handle&&(d=t.handle(p,c,e)),d===!1)if("spa"===e.mode)this.webview.canBack(function(e){e.canBack?o.back(s,r,function(e){history.back()},{showWaiting:t.showWaiting,delay:t.delay}):this.w2aContextWebview&&this.w2aContextWebview.evalJS("window.wap2app&&wap2app.back("+c+",false);")}.bind(this));else if(e.quit)this.w2aContextWebview&&this.w2aContextWebview.evalJS("window.wap2app&&wap2app.back("+c+",false);");else{var u=function(){if(this.webview.__wap2app_group)for(var e=this.webview.__wap2app_group.split(h.W2A_GROUP_SPLIT),t=0;t<e.length;t++){var i=e[t];i!==this.webview.id&&i!==plus.runtime.appid&&plus.webview.close(i,"none",0)}wap2app.destroy(this.webview.id);var n=this.webview.parent();n||(n=this.webview),n.close(s,r)};if(c){var w=plus.webview.currentWebview();w.canBack(function(e){if(e.canBack){if(this.webview.id===h.W2A_BROWSER_CHILD_ID){var t=plus.webview.getWebviewById(h.W2A_BROWSER_ID);t&&t.evalJS("wap2app_browser.showClose();")}this.webview.back()}else u.call(this)}.bind(this))}else u.call(this)}}},e.exports=c},function(e,t,i){var n=i(6),a=i(7),o=i(8),s=i(11),r=i(29),h=i(10),p=i(30),l=i(15),c=i(31),d=i(17),u=i(16),w=i(13),v=i(14),f=i(32),b=i(36),m=i(33),g={},_=w.SCREENSHOT_PATH,y=function(e){this.options=e.globalOptions,this.w2aOptions=e,this.loading=!1,this.backing=!1,this.nativeObjViews={},this.nativeObjBitmaps={},this.templateWebviews={},this.webviewGroups={},this.appName="",this._init()},W=y.prototype;W._init=function(){this._initInfo(),this._initStack(),this._initEvent(),this._initSmsListener(),this._initScreenshots(),this._initTemplates(),this._initArgs(),this._initBijia(),this._initLog(),this._handleGps(),setTimeout(function(){l.init()},1e3)},W._initLog=function(){var e=0;document.addEventListener("pause",function(t){e=n.now()}),document.addEventListener("resume",function(t){var i=n.now()-e;i>6e4?o.resume(parseInt(i/1e3)+""):console.log("W2A[context]:60\u79d2\u5185\u65e0\u9700\u4e0a\u62a5resume\u65e5\u5fd7")})},W._initInfo=function(){var e=w.W2A_APP_NAME+"_"+plus.runtime.version;this.appName=plus.storage.getItem(e),this.appName||plus.runtime.getProperty(plus.runtime.appid,function(t){this.appName=t.name,plus.storage.setItem(e,this.appName)}.bind(this))},W._initArgs=function(){var e=d();e&&e.url&&wap2app.open(e.url,"",plus.runtime.appid)},W._initBijia=function(){v.bijia()&&(u.bijia(),u.init(function(){}))},W._handleGps=function(){var e=this.w2aOptions.homeWebviewOptions;if(e.gps.enable){var t=plus.storage.getItem(w.W2A_GPS_TIME);(!t||n.now()-parseInt(t,10)>60*e.gps.interval*1e3)&&setTimeout(function(){this._checkGps()}.bind(this),10)}},W._checkGps=function(){var e=this.w2aOptions.homeWebviewOptions.gps;p.isEnabled(e.disabledMsg)?p.checkPermission(function(){this.webview.reload()}.bind(this),e.forbiddenMsg)&&plus.storage.setItem(w.W2A_GPS_TIME,n.now()+""):plus.storage.setItem(w.W2A_GPS_TIME,n.now()+"")},W._addContext=function(e){g[e.id]=e},W.removeContext=function(e,t){if(e===plus.runtime.appid)return!1;var i=g[e];if(i&&i instanceof b&&(i.clear(),delete g[e],t!==!1&&i.options.group&&i.webview))for(var n=i.webview.__wap2app_group.split(w.W2A_GROUP_SPLIT),a=0,o=n.length;o>a;a++)this.removeContext(n[a],!1)},W.getContext=function(e){return g[e]},W.getContexts=function(){return g},W.currentContext=function(){var e=plus.webview.getTopWebview();if(e){if(e.__weapp_type)return e;if("normal"===e.__wap2app_type||"home"===e.__wap2app_type||e.id===plus.runtime.appid){var t=g[e.id];return t||e}}for(var i=plus.webview.all(),n=i.length-1;n>=0;n--){var a=i[n];if(a.__weapp_type)return a;if("normal"===a.__wap2app_type||"home"===a.__wap2app_type||a.id===plus.runtime.appid){var t=g[a.id];return t||a}}return!1},W.size=function(){var e=0;for(var t in g)++e;return e},W.destroy=function(e){if(e){var t=this.getContext(e);t&&t.destroy()}},W.clearContext=function(){for(var e in g)e!==plus.runtime.appid&&this.removeContext(e)},W.switchTab=function(e,t){var i=this.webviewGroups[e];i&&i.switchTab(t)},W.getCurrentTabWebview=function(e){var t=this.webviewGroups[e];return t?t.getCurrentWebview():void 0},W._initStack=function(){var e=this.w2aOptions.homeWebviewOptions;if(v.drag()&&e.url&&e.tab){for(var t=[],i=e.tab.items,n=0;n<i.length;n++){var a=plus.runtime.appid+(0===n?"":"_"+n);t.push(this.w2aOptions.webviewsOptions[a])}var o=new f(plus.runtime.appid,{index:0,items:t,isNew:!!e.tab.isNew,height:e.tab.height||"0px",backgroudColor:e.tab.backgroudColor||"#ffffff",onChange:function(e){__wap2app_change_tab_callback(e)}});this.webviewGroups[plus.runtime.appid]=o;for(var a in o.webviewContexts)this._addContext(o.webviewContexts[a])}else this._addContext(new b(this,e.url,e,void 0,!0));this._preloadWebviewContext(e)},W._initEvent=function(){document.addEventListener("splashclosed",function(){var e=function(){var t=plus.webview.getLaunchWebview();t.checkRenderedContent({},function(i){i.rendered||(t.stop(),plus.nativeUI.confirm("\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8bbe\u7f6e",function(i){2===i.index?setting.openAirPlaneModeSetting():1===i.index?(t.reload(),setTimeout(function(){e.call(this)}.bind(this),5e3)):0===i.index&&plus.runtime.quit()}.bind(this),"\u63d0\u793a",["\u9000\u51fa","\u91cd\u8bd5","\u8bbe\u7f6e\u7f51\u7edc"]))}.bind(this),function(){}.bind(this))};e.call(this)}),document.addEventListener("foreground",function(e){this.restoreWebview(),e&&"stream"===e.active&&v.bijia()&&u.bijia(!0)}.bind(this)),plus.key.addEventListener("backbutton",function(){this.back(!0,!0)}.bind(this)),v.restore()&&document.addEventListener("trimmemory",function(){this.clearWebviews()}.bind(this))},W._initSmsListener=function(e){var t=this.options.sms;if("function"==typeof t)setTimeout(function(){r.register(function(e){for(var i=0,n=e.length;n>i&&!t(e[i].getDisplayMessageBody());i++);})},100);else if(n.isObject(t)){var i=t.callback;if(n.isObject(t.callback)&&t.callback.webviewId){var a=t.callback.handle,o=t.callback.webviewId;"function"==typeof o&&(o=o()),"string"==typeof o&&(o=[o]),n.isArray(o)&&o.length&&(i=function(e){for(var t=0;t<o.length;t++){var i=plus.webview.getWebviewById(o[t]);if(i){i.evalJS("("+Function.prototype.toString.call(a)+")("+e+")");break}}})}if("function"==typeof i){var s=t.match;setTimeout(function(){r.register(function(e){for(var t=0,n=e.length;n>t;t++){var a=e[t].getDisplayMessageBody();if(~a.indexOf(s.sign)){var o=new RegExp("([0-9]{"+s.length+"})"),r=a.match(o);if(r&&2===r.length){i(r[1]);break}}}})},100)}}},W._initTemplates=function(){var e=this.w2aOptions.webviewsOptions;for(var t in e){var i=e[t].template;i&&this.getTemplateWebviewById(i)}},W._initScreenshots=function(){var e=this;_=_+plus.runtime.appid+"/";var t=e.w2aOptions.webviewsOptions,i=[],o={};for(var s in t){var r=t[s].screenshot,h=t[s].styles;if(r&&r.url){var p=r.url;"string"==typeof p&&(p=[p]);for(var l=r.view&&r.view.crop.src,d=!!h.statusbar,u=0;u<p.length;u++){var f=p[u];o.hasOwnProperty(f)?l&&(i[o[f]].clip=l):(o[f]=u,i.push({url:f,clip:l,statusbar:d}))}}}o=null,setTimeout(function(){if(v.nativeObj()){var t=[];e._initNativeObjView();var o="0.0.4",s=plus.storage.getItem(w.W2A_SCREENSHOT_VERSION)===o;s||plus.storage.setItem(w.W2A_SCREENSHOT_VERSION,o),c(i,function(i,n){s?v.bitmapRecycle()&&a.android?e._initDrawScreenshotsByIO(t,i,n):e._initDrawScreenshots(t,i,n):(t.push(i),n())},function(){if(t.length){e.currentScreenshot=!1;var i=e._initScreenshotWebview();c(t,function(t,a){e.currentScreenshot={id:t.url,clip:t.clip,statusbar:t.statusbar,callback:a,start:n.now()},i.loadURL("_www/"+t.url)},function(){i.close()})}})}},100)},W.openShare=function(e){l.open(e)},W._initNativeObjView=function(){var e={},t=new plus.nativeObj.View(w.W2A_VIEW_ID,e);t.show(),t.hide(),"function"==typeof t.addEventListener&&t.addEventListener("click",function(e){var t=e.pageX,i=e.pageY;60>=t&&60>=i&&wap2app.back()}),"function"==typeof t.interceptTouchEvent&&t.interceptTouchEvent(!0),this.nativeObjViews[t.id]=t;var i=new plus.nativeObj.View(w.W2A_OTHER_VIEW_ID,e);i.show(),i.hide(),"function"==typeof i.interceptTouchEvent&&i.interceptTouchEvent(!0),this.nativeObjViews[i.id]=i,this.nativeObjBitmaps[w.W2A_BITMAP_ID]=new plus.nativeObj.Bitmap(w.W2A_BITMAP_ID),this.nativeObjBitmaps[w.W2A_OTHER_BITMAP_ID]=new plus.nativeObj.Bitmap(w.W2A_OTHER_BITMAP_ID),this.nativeObjBitmaps[w.W2A_WHITE_BITMAP_ID]=new plus.nativeObj.Bitmap(w.W2A_WHITE_BITMAP_ID)},W._initDrawScreenshotsByIO=function(e,t,i){var n=_+encodeURIComponent(t.url)+".png";plus.io.resolveLocalFileSystemURL(n,function(a){new plus.nativeObj.Bitmap(t.url,n),t.clip?(n=_+encodeURIComponent(t.url+"_header")+".png",plus.io.resolveLocalFileSystemURL(n,function(e){new plus.nativeObj.Bitmap(t.url+"_header",n),i()},function(n){e.push(t),i()})):i()},function(n){e.push(t),i()})},W._initDrawScreenshots=function(e,t,i){var n=new plus.nativeObj.Bitmap(t.url);n.load(_+encodeURIComponent(t.url)+".png",function(){i()},function(a){n.clear(),n=null,e.push(t),i()})},W._initScreenshotWebview=function(){var e=this,t=plus.webview.getWebviewById(w.W2A_SCREENSHOT_WEBVIEW_ID);if(!t)if(a.ios)t=plus.webview.create("",w.W2A_SCREENSHOT_WEBVIEW_ID,{zindex:-1,scrollIndicator:"none",kernel:"UIWebview"},{__wap2app_type:"screenshot"}),t.show("none");else{var i={};v.titlebar()&&(i.height=plus.screen.resolutionHeight-plus.navigator.getStatusbarHeight()+"px"),t=plus.webview.create("",w.W2A_SCREENSHOT_WEBVIEW_ID,i,{__wap2app_type:"screenshot"})}var n=e._drawScreenshot(t);return t.addEventListener("loaded",function(){setTimeout(function(){n()},500)}),t},W._drawScreenshot=function(e){var t=this;return function(){var i=t.currentScreenshot;if(i){var a=i.id,o=i.clip,s=i.statusbar,r=i.callback,h=i.start,p=e.getURL();if("file:///android_asset/data/error.html"===p||"file:///android_asset/data/dcloud_error.html"===p)return void r();var l=new plus.nativeObj.Bitmap(a),c={top:"0px",left:"0px",width:"100%",height:"100%"};s&&plus.navigator.getStatusbarHeight&&(c={top:"0px",height:plus.screen.resolutionHeight-plus.navigator.getStatusbarHeight()+"px"}),e.draw(l,function(){l.save(_+encodeURIComponent(a)+".png",{overwrite:!0},function(){v.bitmapRecycle()?o?(h=n.now(),l.save(_+encodeURIComponent(a+"_header")+".png",{clip:o,overwrite:!0},function(){new plus.nativeObj.Bitmap(a+"_header",_+encodeURIComponent(a+"_header")+".png"),l.recycle&&l.recycle(),r()},function(){l.recycle&&l.recycle(),r()})):(l.recycle&&l.recycle(),r()):r()},function(e){l.clear(),l=null,r()})},function(e){l.clear(),l=null,r()},{check:!0,checkKeyboard:!0,clip:c})}}},W._initBrowser=function(){this.getBrowser()},W.getBrowser=function(e,t,i){var a=this,o=e&&s.getLocation(e)||{},r=plus.webview.getWebviewById(w.W2A_BROWSER_ID);if(!r||t){var h=this.w2aOptions.globalOptions.browser,p=h.url;"function"==typeof p&&(p=p(o.pathname,o)),p||(p="__wap2appbrowser.html"),r=plus.webview.create("_www/"+p,w.W2A_BROWSER_ID,this._getBrowserStyles(o,i),{__wap2app_type:"parent",__wap2app_parent_type:"browser",kernel:"WKWebview"});var l=function(){var e=[],t=n.extend(a.options.browser);if("__wap2appbrowser.html"===p){var i=a.options.browser.styles;for(var o in i)if(i.hasOwnProperty(o)){var s=[],h=i[o];for(var c in h)s.push(c+":"+h[c]+";");e.push(o+"{"+s.join("")+"}")}}t.styles=e.join(""),r.evalJS("wap2app_browser.init('"+JSON.stringify(t)+"')"),r.removeEventListener("loaded",l)};r.addEventListener("loaded",l)}else r.setStyle(this._getBrowserStyles(o,i));return r},W._getBrowserStyles=function(e,t){var i=this.w2aOptions.globalOptions.browser,n={hardwareAccelerated:!0,popGesture:"hide",height:parseInt(i.header.height,10)+1},a="undefined"==typeof t?i.dock:!!t;return"function"==typeof a&&(a=a(e.pathname||"",e)),a?(n.position="dock",n.dock="top"):(n.position="absolute",n.dock=""),n},W.refreshBijia=function(){var e=this.currentContext();e&&(e instanceof plus.webview.Webview||(e=e.webview),e&&e.evalJS("window.wap2app&&wap2app.refreshBijia();"))},W._openBySpa=function(e,t,i){h.open(t,e.id,"replace"===i)},W._openBySelf=function(e,t,i,n,a){e.overrideUrlLoading({mode:"allow",match:w.W2A_OVERRIDE_MATCH,effect:"instant"}),setTimeout(function(){"reload"===n?e.evalJS("window.location.reload();"):a?this._openBySpa(e,t,n):"replace"===n?e.evalJS('window.location.replace("'+t+'");'):e.evalJS('window.location.href = "'+t+'";');var i=this.getContext(e.id);i&&i.handleOverrideUrlLoadingReject()}.bind(this),50)},W._openByScheme=function(e,t){(~t.indexOf("qqmap:")||~t.indexOf("baidumap:")||~t.indexOf("amap:")||~t.indexOf("iosamap:"))&&(window.location.href=t),e.overrideUrlLoading({mode:"allow",match:w.W2A_OVERRIDE_MATCH,effect:"instant"}),setTimeout(function(){e.evalJS('window.location.href="'+t+'";');var i=this.getContext(e.id);i&&i.handleOverrideUrlLoadingReject()}.bind(this),50)},W._openByBlank=function(e,t,i,a,o){var r=this;if(o="undefined"==typeof o?!0:o,i=i||"",!this.loading||t===r.w2aOptions.homeWebviewOptions.url||n.isObject(i)){var h=function(){var h=s.getLocation(t);t=h.href;var p=r.w2aOptions.getWebviewOptionsByUrl(t);if("weapp"===p.mode){var l=p.url(h.pathname,h);if(l)return wx.navigateTo({url:l}),void setTimeout(function(){r.loading=!1},500)}p.url=t,n.isObject(i)&&(p.params=i),setTimeout(function(){r.loading=!1},p.group?0:500),p.quit&&(p.isHome&&"about:blank"===e.getURL()||r.clear()),v.drag()&&p.tab&&p.quit?r.switchTab(plus.runtime.appid,p.id):(r._addContext(new b(r,t,p,e.id,!1,a,o)),r._preloadWebviewContext(p))};r.loading=!0,h()}},W._preloadWebviewContext=function(e){if(e.preload){var t=e.preload;"string"==typeof t&&(t=[t]);for(var i=0;i<t.length;i++){var n=wap2app.getW2AOptions().getWebviewOptionsById(t[i]);n.extras.__wap2app_preload=!0,new b(this,n.url,n,e.id,!0)}}},W.open=function(e,t,i,n,a,o,r){e=e||"blank",a=a||"href",o=o!==!1;var h=s.getLocation(i);if("self"===e){if(!~["http:","https:","file:"].indexOf(h.protocol))return void this._openByScheme(t,i);this._openBySelf(t,i,n,a,o)}else"blank"===e&&this._openByBlank(t,i,n,r,o)},W._back=function(e,t){var i=this.currentContext();if(i)if(i instanceof b||i instanceof m)i instanceof m&&(i=i.groupContext.getCurrentWebviewContext()),i.back(e,t);else if(i instanceof plus.webview.Webview){if(i.__weapp_type)return void wx.navigateBack();i.id!==plus.runtime.appid&&i.close("auto")}},W.restoreWebview=function(){this.restoreTimer&&(window.clearTimeout(this.restoreTimer),this.restoreTimer=!1),this.restoreTimer=setTimeout(function(){var e=!0;if(plus.runtime.isBackground&&plus.runtime.isBackground()&&(e=!1),e){var t=plus.webview.all();if(t.length>3)for(var i=t.length-1;i>=0;i--){var n=t[i],a=n.getURL();if(!a&&n.__wap2app_url){var o=this.getContext(n.id);o&&o.loadURL(n.__wap2app_url);break}}}}.bind(this),300)},W.clearWebviews=function(){this.restoreTimer&&(window.clearTimeout(this.restoreTimer),this.restoreTimer=!1),this.restoreTimer=setTimeout(function(){var e=!0;if(plus.runtime.isBackground&&!plus.runtime.isBackground()&&(e=!1),e)for(var t=plus.webview.all(),i=!0,n=t.length-1;n>=0;n--){var a=t[n];a.__wap2app_url&&"normal"===a.__wap2app_type&&a.id!==plus.runtime.appid&&(i?i=!1:a.clear())}}.bind(this),500)};var x=!1;W.back=function(e,t){if(plus.nativeUI.closeWaiting(),t!==!1){var i=n.now(),a=!1,o=this.currentContext();if(o instanceof b||o instanceof m)o.options.quit&&(a=!0);else if(o instanceof plus.webview.Webview){if(o.__weapp_type)return void wx.navigateBack();o.id===plus.runtime.appid&&(a=!0)}if(!a&&x&&1e3>i-x&&this.size()>1)return void this.close();x=i}this._back(e,t)},W.updateOptions=function(e){if(e){var t=this.currentContext();t&&t instanceof b&&t.updateOptions(e)}},W.close=function(){var e=this.currentContext();e&&e instanceof b&&e.close()},W.show=function(e){var t=this.currentContext();t&&t instanceof b&&t.show(e)},W.quit=function(){if(this.size()){var e=this.currentContext();e&&"function"==typeof e.quit?e.quit():this.getContext(plus.runtime.appid).quit()}},W.getWebviewContextById=function(e){return this.getContext(e)},W.clear=function(){this.clearContext(),setTimeout(function(){for(var e=plus.webview.all(),t=0,i=e.length;i>t;t++){var n=e[t];if(!n.hasOwnProperty("__wap2app_index")&&"normal"===n.__wap2app_type&&!n.__wap2app_preload&&n.id!==plus.runtime.appid){var a=n.parent();a?a.close("none"):n.close("none")}}},20)},W.changeDock=function(e){var t=this.currentContext();t&&t.changeDock&&t.changeDock(e)},W.getTemplateWebviewById=function(e){var t=this.templateWebviews[e];if(!t&&(t=plus.webview.getWebviewById(w.W2A_TEMPLATE_WEBVIEW_ID+e),!t)){var i={popGesture:"none",render:"always"};~e.indexOf(".ios.")&&(i.background="transparent"),t=plus.webview.create(e,w.W2A_TEMPLATE_WEBVIEW_ID+e,i,{__wap2app_type:"template"}),t.addEventListener("loaded",function(){this.templateWebviews[e]=t}.bind(this))}return this.templateWebviews[e]},W.getViewById=function(e){var t=this.nativeObjViews[e];return t||(t=plus.nativeObj.View.getViewById(e),this.nativeObjViews[e]=t),t},W.getBitmapById=function(e){var t=this.nativeObjBitmaps[e];return t||(t=plus.nativeObj.Bitmap.getBitmapById(e),this.nativeObjBitmaps[e]=t),t},W.preload=function(e,t){},e.exports=y},function(e,t,i){var n,a,o,s=i(6).plusReady,r=[],h=!1,p=!1,l=!1,c=function(e){if("Android"===plus.os.name)try{var t=plus.runtime.innerVersion.split(".");l=parseInt(t[t.length-1])<22298,o=plus.android.runtimeMainActivity(),plus.android.importClass("android.content.Intent");var i=plus.android.importClass("android.content.IntentFilter"),s=plus.android.importClass("android.telephony.SmsMessage"),h="io.dcloud.feature.internal.reflect.BroadcastReceiver";l&&(h="io.dcloud.feature.internal.a.a"),a=new i;var p=function(e,t){try{var i=t.getAction();if("android.provider.Telephony.SMS_RECEIVED"==i){for(var n=t.getSerializableExtra("pdus"),a=[],o=0,h=n.length;h>o;o++)a.push(s.createFromPdu(n[o]));for(var o=0,h=r.length;h>o;o++)r[o](a)}}catch(p){}};n=plus.android["implements"](h,{a:p,onReceive:p}),a.addAction("android.provider.Telephony.SMS_RECEIVED"),e&&e()}catch(c){}},d=function(e){if(r.push(e),h){if(!p)try{l?o.a(n,a):o.registerReceiver(n,a)}catch(t){}}else h=p=!0,s(function(){c(function(){setTimeout(function(){try{l?o.a(n,a):o.registerReceiver(n,a)}catch(e){}},300)})})},u=function(e,t){for(var i=0,a=r.length;a>i;i++)r[i]===e&&r.splice(i,1);if(t&&!r.length&&o&&p){try{l?o.a(n):o.unregisterReceiver(n)}catch(s){}p=!1}};e.exports={register:d,unregister:u}},function(e,t,i){var n=i(7),a=i(21),o=["\u786e\u5b9a","\u53d6\u6d88"],s=!1;e.exports={isEnabled:function r(e,t){if("iOS"===plus.os.name)return!0;if(!s){var r=!0;try{var i=plus.android.runtimeMainActivity(),n=i.getSystemService("location"),h=plus.android.importClass(n),p=n.isProviderEnabled(h.GPS_PROVIDER);p||(r=!1)}catch(l){console.error(l),r=!1}return r||("function"==typeof e&&(t=e,e=""),(e||t)&&(e=e||"\u672c\u673a\u672a\u5f00\u542f\u5b9a\u4f4d\u529f\u80fd\uff0c\u70b9\u786e\u5b9a\u8fdb\u5165\u8bbe\u7f6e\u5f00\u542f\u5b9a\u4f4d\u529f\u80fd","Android"===plus.os.name&&(s=!0,plus.nativeUI.confirm(e,function(e){0===e.index?(a.openLocationSource(),t&&t()):s=!1},"\u63d0\u793a",o)))),r}},checkPermission:function(e,t,i){if("iOS"===plus.os.name)return!0;if(!s){var r=!0;try{var h=plus.android.runtimeMainActivity(),p=plus.android.importClass("android.os.Build"),l=plus.android.importClass("android.content.Context");if(p.VERSION.SDK_INT>=19){var c=h.getSystemService(l.APP_OPS_SERVICE),d=plus.android.importClass(c),u=h.getPackageManager();plus.android.importClass(u);var w=u.getPackageInfo(h.getPackageName(),0),v=plus.android.getAttribute(plus.android.getAttribute(w,"applicationInfo"),"uid"),f=h.getPackageName();"io.dcloud.streamapp"===f&&(f="com.qihoo.appstore");var b=c.checkOp(d.OPSTR_COARSE_LOCATION,v,f);if(b==d.MODE_ERRORED){var m;m=plus.android["implements"]("android.app.AppOpsManager$OnOpChangedListener",{onOpChanged:function(t,i){var n=c.checkOp(d.OPSTR_COARSE_LOCATION,v,f);t==d.OPSTR_COARSE_LOCATION&&n==d.MODE_ALLOWED&&(e&&e(),c.stopWatchingMode(m))}}),c.startWatchingMode(d.OPSTR_COARSE_LOCATION,f,m),r=!1}}}catch(g){console.log(g)}return r||("function"==typeof t&&(i=t,t=""),(t||i)&&(t=t||"\u5c1a\u672a\u8d4b\u4e88\u83b7\u53d6\u4f4d\u7f6e\u7684\u6743\u9650\u3002\u70b9\u786e\u5b9a\u8fdb\u5165\u8bbe\u7f6e\uff0c\u7ed9{app}\u8d4b\u4e88\u5b9a\u4f4d\u6743\u9650",plus.runtime.getProperty(plus.runtime.appid,function(e){var r=e.name;n.qihoo?r="360\u624b\u673a\u52a9\u624b":n.stream&&(r="\u6d41\u5e94\u7528"),t=t.replace("{app}",r),"Android"===plus.os.name&&(s=!0,plus.nativeUI.confirm(t,function(e){0===e.index?(a.openApplicationDetail(),i&&i()):s=!1},"\u63d0\u793a",o))}))),r}}}},function(e,t){e.exports=function(e,t,i){var n=function(a,o){return a.length<1?i&&i():void t(a.shift(),function(){n(e,o)})};n(e,t)}},function(e,t,i){var n=i(33),a=function(e,t){this.id=e,this.options=t,this.styles=t.styles,this.items=t.items,this.onChange=t.onChange,this.options.index=t.index||0,this.webviews={},this.webviewContexts={},this.currentWebview=!1,this._init()},o=a.prototype;o._init=function(){this._initParent(),this._initNativeView(),this._initWebviewContexts(this.options.index)},o._initParent=function(){this.parent=plus.webview.getWebviewById(this.id),this.parent||(this.parent=plus.webview.create(this.id,this.id),this.parent.show("none"))},o._initNativeView=function(){var e=plus.webview.getLaunchWebview(),t=e.getStyle();this.top=0,this.bottom=0,t.hasOwnProperty("top")&&(this.top=t.top),t.hasOwnProperty("bottom")&&(this.bottom=t.bottom),this.options.height&&parseInt(this.options.height)&&(this.top=this.options.height),this.nativeView=new plus.nativeObj.View("__W2A_TAB_NATIVE",{top:this.top,bottom:this.bottom,left:"100%",height:"100%",width:"100%",backgroudColor:this.options.backgroudColor||"#ffffff"}),this.nativeView.show()},o._initWebviewContexts=function(){for(var e=this.items.length,t=e-1;t>=0;t--){var i=this.items[t],a=i.id,o=0===t,s=t===e-1,r=this.options.index===t,h=i.extras;h.__wap2app_url=i.url,h.__wap2app_index=t,h.__wap2app_left=o?"":this.items[t-1].id,h.__wap2app_right=s?"":this.items[t+1].id;var p=i.styles;t>this.options.index?p.left="100%":t<this.options.index?p.left="-100%":p.left="0",this.options.isNew&&(p.top=this.top,p.bottom=this.bottom);var l=new n(a,i,this);this.webviewContexts[a]=l,r&&(l.webview=plus.webview.getWebviewById(a),l.createWebview(),this._initDrags(l.webview),this.currentWebview=l.webview)}},o._onChange=function(e){this.currentWebview=e,this.onChange({index:e.__wap2app_index})},o._dragCallback=function(e,t,i,n){if(i===this.nativeView){this.webviewContexts[n].createWebview("drag");var a=this.webviewContexts[n].webview;this.options.isNew||a.showBehind(plus.webview.getSecondWebview()),this.nativeView.setStyle({left:"100%"}),this._initDrags(a),this._onChange(a),this._checkDrags(a)}else this._onChange(i)},o._initDrag=function(e,t){var i="__wap2app_drag_"+t+"_flag";if(!e[i]){var n=e["__wap2app_"+("left"===t?"right":"left")];if(n){var a=plus.webview.getWebviewById(n);a?e[i]=!0:a=this.nativeView,e.drag({direction:t,moveMode:"followFinger"},{view:a,moveMode:"follow"},function(i){"end"===i.type&&i.result&&this._dragCallback(t,e,a,n)}.bind(this))}else e[i]=!0}},o._initDrags=function(e){e.__wap2app_drag_left_flag&&e.__wap2app_drag_right_flag,this._initDrag(e,"left"),this._initDrag(e,"right")},o._checkDrags=function(e){var t=e.__wap2app_left,i=e.__wap2app_right;if(t){var n=plus.webview.getWebviewById(t);n&&!n.__wap2app_drag_left_flag&&this._initDrag(n,"left")}if(i){var a=plus.webview.getWebviewById(i);a&&!a.__wap2app_drag_right_flag&&this._initDrag(a,"right")}},o.getCurrentWebview=function(){return this.currentWebview},o.getCurrentWebviewContext=function(){return this.currentWebview?this.webviewContexts[this.currentWebview.id]:!1},o.switchTab=function(e){e=e.replace("_0","");var t=this.currentWebview;if(e!==t.id){var i=this.webviewContexts[e],n=i.webview,a="100%",o="-100%";i.options.extras.__wap2app_index>t.__wap2app_index&&(a="-100%",o="100%");var s=!1;n||(s=!0,i.createWebview("startAnimation"),n=i.webview,this.options.isNew||n.showBehind(plus.webview.getSecondWebview()),this._initDrags(n),this._checkDrags(n));plus.webview.startAnimation({view:t,styles:{fromLeft:"0",toLeft:a},action:"show"},{view:n,styles:{fromLeft:o,toLeft:"0"},action:"show"},function(e){e.id===n.id&&(s&&plus.nativeUI.showWaiting(),this.currentWebview=n,this.onChange({index:n.__wap2app_index}))}.bind(this))}},e.exports=a},function(e,t,i){var n=(i(6),i(13)),a=i(14),o=i(34),s=i(35),r=function(e,t,i){this.id=e,this.url=t.url,this.options=t,this.groupContext=i,this.webview=!1,this.inited=!1,this.canEvalJS=!1},h=r.prototype;h.createWebview=function(e){var t=this.options;if(t.styles.popGesture="none",this.webview){this.webview.setStyle(t.styles);for(var i in t.extras)this.webview[i]=t.extras[i]}else t.styles.left="100%","startAnimation"!==e&&(t.styles.left="0",plus.nativeUI.showWaiting()),this.webview=plus.webview.create(this.url,this.id,t.styles,t.extras),this.groupContext.options.isNew&&(plus.webview.getSecondWebview().append(this.webview),this.webview.show("none")),this.webview.overrideUrlLoading({mode:"allow",match:n.W2A_OVERRIDE_MATCH,effect:"instant"});this._initWebview(),this.inited=!0},h._initWebview=function(){var e=this.options;if(this.webview){o.appendJsFile(this.webview,e),o.listenResourceLoading(this.webview,e),o.overrideResourceRequest(this.webview,e),this.webview.addEventListener("rendering",function(){setTimeout(function(){plus.nativeUI.closeWaiting()},500)}),this.webview.addEventListener("loaded",function(){this.canEvalJS=!0}.bind(this)),this.w2aWebviewOverrideUrlLoading=new s(this.webview,e),this.w2aWebviewOverrideUrlLoading.reject();var t=e.injectStyle;if(t&&("function"==typeof t&&(t=t()),t&&"string"==typeof t&&this.webview.setCssText(t)),this.webview.setFixBottom&&this.options.fixBottom&&this.webview.setFixBottom(this.options.fixBottom),e.pullToRefresh&&e.pullToRefresh.support&&a.pullToRefresh()){var i=e.pullToRefresh.callback;this.webview.setPullToRefresh(e.pullToRefresh,function(){if(i)i(this.webview);else{var e=this,t=function(){setTimeout(function(){e.webview.endPullToRefresh()}.bind(this),1e3),e.webview.removeEventListener("titleUpdate",t)};this.webview.addEventListener("titleUpdate",t),this.webview.reload()}}.bind(this))}}},h.back=function(e,t){if(t!==!1){if(this.options.back.backbutton&&(this.canEvalJS||plus.runtime.appid===this.webview.id))return void this.webview.evalJS("window.wap2app&&wap2app.back();");
this.options.back.backbutton||(e=!1)}this.options.back.backbutton&&(this.canEvalJS||plus.runtime.appid===this.webview.id)?this.webview.evalJS("window.wap2app&&wap2app.quit()"):this.quit()};var p=null;h.quit=function(){p?+new Date-p<2e3&&plus.runtime.quit():(p=+new Date,plus.nativeUI.toast("\u518d\u6309\u4e00\u6b21\u9000\u51fa\u5e94\u7528"),setTimeout(function(){p=null},2e3))},h.handleOverrideUrlLoadingReject=function(){this.w2aWebviewOverrideUrlLoading&&this.w2aWebviewOverrideUrlLoading.reject()},e.exports=r},function(e,t,i){var n=i(6),a=function(e,t){"function"==typeof e.listenResourceLoading&&e.listenResourceLoading({match:t.listenResourceLoading.match},function(e){})},o=function(e,t){if("function"==typeof e.overrideResourceRequest){var i=t.overrideResourceRequest;n.isObject(i)&&(i=[i]),i&&i.length&&e.overrideResourceRequest(i)}},s=function(e,t){e.appendJsFile("_www/__wap2app.js"),e.appendJsFile("_www/__wap2appconfig.js");var i=t.appendJsFile;if("string"==typeof i&&i&&(i=[i]),n.isArray(i))for(var a=0,o=i.length;o>a;a++)i[a]&&e.appendJsFile("_www/"+i[a])};e.exports={appendJsFile:s,listenResourceLoading:a,overrideResourceRequest:o}},function(e,t,i){var n=i(6),a=i(11),o=i(22),s=i(13),r=i(12),h=function(e,t,i){this.webview=e,this.options=t,this.relatedView=i,this.lastOpenTime=!1},p=h.prototype;p.getW2AContext=function(){return wap2app.getContext()},p.getW2AOptions=function(){return wap2app.getW2AOptions()},p.reject=function(){var e=this.webview,t=this.options;setTimeout(function(){var i=function(){"function"==typeof e.overrideUrlLoading&&t.overrideUrlLoading!==!1&&(this.lastOpenTime=!1,e.overrideUrlLoading({mode:"reject",match:".*",exclude:t.overrideUrlLoading.exclude},function(i){if(this.lastOpenTime){var a=n.now()-this.lastOpenTime;if(50>a)return}var o=t.overrideUrlLoading.handle;if("function"==typeof o){var h=o(i.url,e);h&&"string"==typeof h&&(i.url=h)}this.relatedView&&this.relatedView instanceof r&&this.relatedView.clear(),this.relatedView&&"parent"!==this.relatedView.__wap2app_type&&this.relatedView instanceof plus.webview.Webview&&this.relatedView.id!==s.W2A_BROWSER_ID&&this.relatedView.isVisible()&&(this.relatedView.hide("none",0,{acceleration:"none"}),this.relatedView.restore()),this.open(i.url,"",this.webview.getURL())}.bind(this)))};i.call(this)}.bind(this),t.overrideUrlLoading.delay)},p.open=function(e,t,i){var o=this.options,r=a.getLocation(e);if(!o.overrideUrlLoading.block||!n.isMatch(r,{matchPathnames:o.overrideUrlLoading.block})){if(~s.W2A_OVERRIDE_IGNORE.indexOf(r.protocol))return void this.getW2AContext().open("self",this.webview,e);if(~["http:","https:","file:"].indexOf(r.protocol)){var h=o.overrideUrlLoading.download;if("function"==typeof h){var p=h(r.pathname,r);if(p)return p.msg&&plus.nativeUI.toast(p.msg),void("allow"===p.mode&&plus.runtime.openURL(r.href))}this.lastOpenTime=n.now();var l=o.isRedirect?o.overrideUrlLoading.redirect:!1;if(!l){var c=this.getW2AOptions().getRedirectWebviewOptionsByUrl(i);c&&(l=c.overrideUrlLoading.redirect,o.redirect_id=c.id,o.redirect_url=i,o.isRedirect=!0,o.overrideUrlLoading.redirect=l)}if(l){var d=!1,u=this.redirect(r,l);n.isObject(u)&&(e=u.url,u=u.type);var w="self";if("href"===u){var v=this.getW2AOptions().isConfiged(e);v&&v!==this.webview.id&&(v===o.redirect_id&&(d=!0),w="blank")}else"blank"===u&&(d=!0,w="blank");if("blank"===w&&this.temporary(e,o.overrideUrlLoading.temporary,t,i))return;this.getW2AContext().open(w,this.webview,e,t,u,"blank"===w,function(e){"shown"===e&&setTimeout(function(){if(d&&this.webview.close("none"),"blank"===u){var e=l.reload;if(typeof e===!0&&(e=[this.opener.id]),"function"==typeof e&&(e=e(r.pathname,r)),"string"==typeof e&&(e=[e]),n.isArray(e))for(var t=0,i=e.length;i>t;t++){var a=plus.webview.getWebviewById(e[t]);a&&a.reload()}}}.bind(this),0)}.bind(this))}else if("history"===o.mode){var u="href",v=this.getW2AOptions().isConfiged(e),w="self",f=!1;v&&v!==this.webview.id&&(n.isArray(o.history)&&~o.history.indexOf(v)||(w="blank",f=!0)),"self"===w&&this.webview.id===s.W2A_BROWSER_CHILD_ID&&(f=!1),u&&this.getW2AContext().open(w,this.webview,e,t,u,f)}else this.temporary(e,o.overrideUrlLoading.temporary,t,i)||this.ignore(e,t,i)}}},p.redirect=function(e,t){var i="href",s=!1;if(t.handle&&(s=t.handle()),!s){var r=!1,h=a.getLocation(this.options.redirect_url||this.options.url),p=t.paramName;if(p&&("function"==typeof p?r=p(e.pathname,e):"string"==typeof p&&(p={url:p}),!r)){if(p.url){var l=p.url;"string"==typeof l&&(l=[l]);for(var c=0;c<l.length&&!(r=n.getUrlParam(l[c],h.href));c++);}!r&&p.cookie&&p.cookie.url&&(r=o.get(p.cookie.url,p.cookie.name),r&&(r=decodeURIComponent(r))),!r&&p.localStorage&&(r=localStorage.getItem(p.localStorage)),!r&&p.sessionStorage&&(r=sessionStorage.getItem(p.sessionStorage)),r||(r=this.redirect_url)}if(r||(r=t.defaultUrl),r){var h=a.getLocation(r);"function"==typeof t.match?s=t.match(e.pathname,e,h.pathname,h):e.pathname===h.pathname&&(s=!0)}}if(s){if(s!==!0)return{type:"blank",url:s};i="blank"}return i},p.temporary=function(e,t,i,n){if("function"==typeof t){var o=a.getLocation(e),r=t(o.pathname,o);if(r){"string"==typeof r&&(r={regex:r});var h=r.regex,p=plus.webview.getWebviewById(s.W2A_TEMPORARY_WEBVIEW_ID);return p?p.loadURL(e):p=plus.webview.create(e,s.W2A_TEMPORARY_WEBVIEW_ID),p.overrideUrlLoading({mode:"reject",match:h},function(e){var t=e.url;if("function"==typeof r.handle){var o=a.getLocation(t);t=r.handle(o.pathname,o),t||(t=e.url)}this.open(t,i,n),p.close("none")}.bind(this)),!0}}return!1},p.ignore=function(e,t,i){var o=this.options,s=!1,h=!1,p=o.ignore,l=o.overrideUrlLoading.ignore,c=o.group,d=a.getLocation(e);if(p&&(s=n.isMatch(d,{matchPathnames:p})),s===!1&&l&&(s=n.isMatch(d,{matchPathnames:l})),s===!1&&c&&n.isMatch(d,{matchPathnames:c.matchPathnames}))return void this.getW2AContext().open("blank",this.webview,e,t);if(s===!1&&o.matchPathnames&&n.isMatch(d,o)&&(s=!0),null!==s)if(s){var u=this.loadType(d,a.getLocation(i));u&&this.getW2AContext().open("self",this.webview,e,t,u,h)}else this.relatedView&&this.relatedView instanceof r&&this.relatedView.setStopped(!0),this.getW2AContext().open("blank",this.webview,e,t)},p.loadType=function(e,t){var i=this.options,o="href";if(this.isReplace(e)&&(o="replace"),"replace"!==o){var s=!1;"boolean"!=typeof i.reload?s=n.isMatch(a.getLocation(i.url),{matchPathnames:i.reload}):i.reload&&(s=!0),e.href!==t.href||s||e.hash!==t.hash&&(o="reload")}return o},p.isReplace=function(e){var t=!1,i=this.options.overrideUrlLoading.replace;return"boolean"==typeof i?t=i:i&&(t=n.isMatch(e,{matchPathnames:i})),t},e.exports=h},function(e,t,i){var n=i(6),a=i(7),o=i(11),s=i(10),r=i(17),h=i(21),p=i(22),l=i(13),c=i(14),d=i(12),u=i(37),w=i(26),v=i(34),f=i(35),b=function(e,t,i,n,a,o,s){i||(i=t,t=!1),this._init(e,i,o,s),this._create(n,a,s)},m=b.prototype;m._init=function(e,t,i,a){this.w2aContext=e,this.id=t.id,this.uuid=n.now(),this.opener=!1,this.webview=!1,this.relatedView=!1,this.nativeView=!1,this.titleUpdateTimer=!1,this.canTitleUpdateTimer=!1,this.backing=!1,this.showing=!1,this.shown=!1,this.loaded=!1,this.cleared=!1,this.animate=a!==!1,this.animating=!1,this.canTitleUpdate=!1,this.canEvalJS=!1,this.history=[],this.options=t,this.callback=i,this.redirect_url=!1},m._create=function(e,t,i){n.plusReady(function(){this._hasNetwork(e,t)?this._createWebview(e,t,i):(this.opener=e&&plus.webview.getWebviewById(e),this.opener&&this.opener.evalJS("wap2app&&wap2app.$$group_reset&&wap2app.$$group_reset()"))}.bind(this))},m._createWebview=function(e,t,i){var s=this.options;this.opener=e&&plus.webview.getWebviewById(e),this.webview=plus.webview.getWebviewById(s.id),s.id===plus.runtime.appid&&(this.shown=!0);var r=!1;if(!this.opener||this.opener.id!==s.id){var h=this.opener&&this.opener.__wap2app_group,p=s.extras.__wap2app_group;if(!h&&this.opener){var d=this.w2aContext.w2aOptions.homeWebviewOptions;this.opener.id===plus.runtime.appid&&(h=d.extras.__wap2app_group)}p&&p===h&&(r=!0)}var u=!1;if(!this.webview||this.webview.id===plus.runtime.appid||r||s.extras.__wap2app_group||(this.webview.id!==e&&(this.webview.close("none"),u=!0),this.webview=null),this.webview){if(this.webview&&this.webview.setFixBottom&&this.options.fixBottom&&this.webview.setFixBottom(this.options.fixBottom),this.webview.__wap2app_preload,s.isHome&&(this.canTitleUpdate=!0),this.w2aWebviewOverrideUrlLoading||(this.w2aWebviewOverrideUrlLoading=new f(this.webview,this.options,this.relatedView)),!s.isHome&&this.webview.__wap2app_event||this._initPlusWebview(),t)return this.titleUpdateTimer&&clearTimeout(this.titleUpdateTimer),void(this.loadedTimer&&clearTimeout(this.titleUpdateTimer));var v=!!this.webview.__wap2app_group||!!s.group;if(s.url){this._overrideResourceRequest();var b=!1;"boolean"!=typeof s.reload?b=n.isMatch(o.getLocation(s.url),{matchPathnames:s.reload},[this.webview]):s.reload&&(b=!0),b||(b=!!this.webview.__wap2app_preload),b||(b=!!s.params&&s.params.reload);var m=!1;if(b||this.webview.id!==plus.runtime.appid||"about:blank"!==this.webview.getURL()||(m=!0,b=!0),b?(s.id!==e&&!this._isBrowserWebview()&&!v,this.webview.overrideUrlLoading({mode:"allow",match:l.W2A_OVERRIDE_MATCH,effect:"instant"}),setTimeout(function(){this.webview.evalJS('window.location.replace("'+s.url+'")'),setTimeout(function(){this.handleOverrideUrlLoadingReject()}.bind(this),m?100:0)}.bind(this),50)):(this.loaded=!0,this.canEvalJS=!0,this.titleUpdateTimer&&clearTimeout(this.titleUpdateTimer),this.loadedTimer&&clearTimeout(this.titleUpdateTimer),setTimeout(function(){plus.nativeUI.closeWaiting()},30)),m)return;if(this.webview.__wap2app_preload)this.webview.setStyle({zindex:0}),this._createAppend();else{var g="none",_=0,y=s.parent&&"browser"!==s.parent?this.webview.parent():this.webview;y||(y=this.webview),"browser"===y.__wap2app_parent_type&&this.webview.clear(),y.id!==plus.runtime.appid&&y.hide("none"),setTimeout(function(){y.show(g,_,function(){this.opener&&this.opener.evalJS("wap2app&&wap2app.$$group_reset&&wap2app.$$group_reset()"),plus.nativeUI.closeWaiting(),this.callback&&this.callback("shown",this.webview)}.bind(this))}.bind(this),50)}}}else{if(s.showBehind=s.params&&s.params.showBehind||!1,s.showBehind||(r&&!this.nativeView&&this._createNativeView(),s.navigationbar||this.opener.id===s.id||r||s.group&&s.group.tabbar.list.length&&c.nativeViewDraws()||("browser"!==s.parent&&(t||this._createScreenShot(i)),t||this._createAppend(u))),s.extras.__wap2app_opener_id=e,s.extras.__wap2app_event=!t,s.extras.__wap2app_url=s.url,s.extras.__wap2app_preload&&(s.styles.zindex=-1),s.styles.errorPage&&0===s.styles.errorPage.indexOf("_www")&&(s.styles.errorPage=plus.io.convertLocalFileSystemURL(s.styles.errorPage)),s.navigationbar){s.extras.__wap2app_group||(s.styles.backButtonAutoControl="close");var W=void 0;if("string"==typeof s.navigationbar.titleText)W=s.navigationbar.titleText;else if(n.isObject(s.navigationbar.titleText))if(s.navigationbar.titleText.auto)"function"==typeof s.navigationbar.titleText.filter&&(W="");else if("function"==typeof s.navigationbar.titleText.filter){var x=o.getLocation(s.url);W=s.navigationbar.titleText.filter(x.pathname,x)}var k=null;s.navigationbar.borderColor&&(k={color:s.navigationbar.borderColor}),s.styles=n.extend(s.styles,{navigationbar:s.navigationbar},{navigationbar:{titleText:W,backButton:{color:s.navigationbar.titleColor},splitLine:k}})}if(s.navigationbar&&s.subNViews&&c.subNView()&&(s.styles.subNViews=this._handleSubNViews(s.subNViews)),this.webview=plus.webview.create(s.url,s.id,s.styles,s.extras),s.navigationbar){var T=a.ios?!1:this._createNViewByNavigationbar(s.navigationbar);this.navigationbar=this.webview.getNavigationbar(),setTimeout(function(){this.navigationbar||(this.navigationbar=this.webview.getNavigationbar()),(s.navigationbar.icons.home||s.navigationbar.icons.share||!c.navigationbarBack())&&this.navigationbar&&((s.navigationbar.icons.back||s.navigationbar.icons.home||s.navigationbar.icons.share)&&this.navigationbar.addEventListener("click",function(e){var t=e.clientX,i=e.clientY;s.navigationbar.icons.back&&!c.navigationbarBack()&&n.isCross(t,i,{top:0,left:0,width:60,height:60})?wap2app.back():s.navigationbar.icons.share&&n.isCross(t,i,{top:0,left:plus.screen.resolutionWidth-(s.navigationbar.icons.home?78:44),width:44,height:60})?this.webview.evalJS("window.wap2app&&wap2app.openShare()"):s.navigationbar.icons.home&&n.isCross(t,i,{top:0,left:plus.screen.resolutionWidth-34,width:44,height:60})&&wap2app.open(this.w2aContext.w2aOptions.homeWebviewOptions.url)}.bind(this)),s.navigationbar.icons.share&&this.navigationbar.drawText("\ue602",{top:0,right:s.navigationbar.icons.home?34:0,width:44,height:44},{size:"30px",color:s.navigationbar.titleColor,fontSrc:"__wap2app.ttf"}),s.navigationbar.icons.home&&this.navigationbar.drawText("\ue603",{top:0,right:0,width:44,height:44},{size:"27px",color:s.navigationbar.titleColor,fontSrc:"__wap2app.ttf"}),c.navigationbarBack()||this.navigationbar.drawText("\ue601",{top:0,left:0,width:44,height:44},{size:"27px",color:s.navigationbar.titleColor,fontSrc:"__wap2app.ttf"}))}.bind(this),100),this.shown=!0,this.webview.show(s.show.aniShow,s.show.duration,function(){T&&T.close()},{capture:T,action:"close"})}else this.parentWebview?(this.parentWebview.append(this.webview),this.webview.show("none"),this.shown=!0):this.relatedView&&this.relatedView instanceof w&&(this.animating=!0,this.relatedView.hasTabbar?(this.parent=plus.webview.create("",this.options.extras.__wap2app_parent,{popGesture:"close"}),this.parent.append(this.webview),this.parent.append(this.relatedView.getView()),this.parent.show(s.show.aniShow,s.show.duration,function(){this.animating=!1,this.webview.show("none")}.bind(this))):this.webview.show(s.show.aniShow,s.show.duration,function(){var e=this.relatedView.getDockView();e&&this.webview.append(e),this.animating=!1}.bind(this),{capture:this.relatedView.getView()}));if(this._overrideResourceRequest(),s.injectStyle&&this.webview.setCssText){var I=s.injectStyle;if("function"==typeof s.injectStyle){var O=o.getLocation(s.url);I=s.injectStyle(O.pathname,O)}I&&this.webview.setCssText(I)}t||this._prepareLoading(),s.blockNetworkImage&&this.webview.setBlockNetworkImage(!0),this.webview.overrideUrlLoading({mode:"allow",match:l.W2A_OVERRIDE_MATCH,effect:"instant"},function(e){}.bind(this)),r&&!t?this._createGroupScreenshot():(this.options.extras.__wap2app_group&&s.group.tabbar.list.length&&c.nativeViewDraws()&&this._createGroupScreenshot(!0),h&&setTimeout(function(){this._clearGroup(h)}.bind(this),500)),this._isBrowserWebview()?(this.webview.append(this.relatedView),this.webview.show(s.show.aniShow,s.show.duration,function(){}.bind(this))):this._hasParentWebview()&&(this.webview.hide(),this.relatedView.append(this.webview)),this._hasNativeView()&&this.webview.append(this.nativeView.view),this.w2aWebviewOverrideUrlLoading=new f(this.webview,this.options,this.relatedView),t&&this.webview.id===plus.runtime.appid||(t&&this.webview.id!==plus.runtime.appid?this._initPlusWebview(!1):this._initPlusWebview()),this.webview&&this.webview.setFixBottom&&this.options.fixBottom&&this.webview.setFixBottom(this.options.fixBottom)}},m._handleSubNViews=function(e){var t=plus.storage.getItem(this.options.id);if(t){t=JSON.parse(t);for(var i=0;i<e.length;i++)for(var n=e[i],a=0;a<n.tags.length;a++){var o=n.tags[a];"img"===o.tag?o.src=t[o.id]||"":"font"===o.tag&&(o.text=t[o.id]||"")}return plus.storage.removeItem(this.options.id),e}return null},m._createNViewByNavigationbar=function(e){var t="navigationbar_nview_"+this.id+"_"+Math.random(),i=[{id:t+"_bg",tag:"rect",color:"#ffffff",position:{top:0,left:0,width:"100%",height:"100%"}},{id:t+"_head_bg",tag:"rect",color:e.backgroundColor,position:{top:0,left:0,width:"100%",height:44}},{id:t+"_head_back",tag:"font",position:{top:0,left:0,width:44,height:44},text:"\ue601",textStyles:{size:"27px",color:e.titleColor,fontSrc:"__wap2app.ttf"}}];return e.borderColor&&i.push({id:t+"_head_border",tag:"rect",color:e.borderColor,position:{top:43,left:0,width:"100%",height:1}}),"string"==typeof e.titleText&&e.titleText&&i.push({id:t+"_head_title",tag:"font",position:{top:0,left:0,width:"100%",height:44},text:e.titleText,textStyles:{size:e.titleSize,color:e.titleColor}}),new plus.nativeObj.View(t,{top:0,left:0,width:"100%",height:"100%"},i)},m.loadURL=function(e){this.webview.overrideUrlLoading({mode:"allow",match:l.W2A_OVERRIDE_MATCH,effect:"instant"}),setTimeout(function(){this.webview.loadURL(e),setTimeout(function(){this.handleOverrideUrlLoadingReject()}.bind(this),1e3)}.bind(this),50)},m._clearGroupByLimit=function(e,t){if(t){for(var i=e.split(l.W2A_GROUP_SPLIT),n=plus.webview.all(),a=[],o=n.length-1;o>=0;o--){var s=n[o],r=s.id;~i.indexOf(r)&&a.push(r)}for(var h=a.splice(t),o=0;o<h.length;o++){var r=h[o];r!==plus.runtime.appid&&plus.webview.close(h[o],"none")}}},m._clearGroup=function(e){if(!c.drag()||!this.w2aContext.w2aOptions.homeWebviewOptions.tab)for(var t=e.split(l.W2A_GROUP_SPLIT),i=0,n=t.length;n>i;i++){var a=t[i];this.opener.id!==a&&a!==plus.runtime.appid&&a!==this.webview.id&&plus.webview.close(a,"none")}},m._listenResourceLoading=function(){v.listenResourceLoading(this.webview,this.options)},m._overrideResourceRequest=function(){v.overrideResourceRequest(this.webview,this.options)},m._initPlusWebview=function(e){var t=this.options;t.isHome||v.appendJsFile(this.webview,t),e!==!1&&this._handleEvent(),this.handleOverrideUrlLoadingReject(),this._isBrowserWebview()||this._setPullToRefresh(this.options.url)},m._setPullToRefresh=function(e){var t=this.options;if(t.pullToRefresh===!0&&(t.pullToRefresh={support:!0,style:"circle"}),t.pullToRefresh&&t.pullToRefresh.support&&c.pullToRefresh()){var i=!0;if("function"==typeof t.pullToRefresh.support&&e&&"null"!==e){var a=o.getLocation(e);i=t.pullToRefresh.support(a.pathname,a)}if(i===!1)return;var s=t.pullToRefresh.callback;return"undefined"==typeof t.pullToRefresh.offset&&this._isBrowserWebview()&&(t.pullToRefresh.offset=this.options.dock?"0px":parseInt(this.w2aContext.w2aOptions.globalOptions.browser.header.height,10)+1),this.webview.setPullToRefresh(n.extend({},t.pullToRefresh,{support:!0}),function(){if(s)s(this.webview);else{var e=this,t=function(){setTimeout(function(){e.webview.endPullToRefresh()}.bind(this),1e3),e.webview.removeEventListener("titleUpdate",t)};this.webview.addEventListener("titleUpdate",t),this.webview.reload()}}.bind(this)),!0}},m._hasNativeView=function(){return!!this.nativeView},m._hasParentWebview=function(){return this.relatedView&&"parent"===this.relatedView.__wap2app_type},m._hasScreenshot=function(){return this.relatedView&&"screenshot"===this.relatedView.__wap2app_type},m._isBrowserWebview=function(){return this._hasParentWebview()&&"browser"===this.relatedView.__wap2app_parent_type},m._createGroupScreenshot=function(e){var t=this;if(t.webview.__wap2app_tabbar){var i=t.options.group.tabbar,n=new u(t.options.id,i,function(e,i){wap2app.open(e.url,"",t.webview.id)});if(t.webview.append(n.getView()),e){var a=t.options.show;t.webview.show(a.aniShow,a.duration)}else t.webview.show("none",0)}else{var o=function(){t.opener&&t.opener.evalJS("wap2app&&wap2app.$$group_reset&&wap2app.$$group_reset()")};if(c.nativeObj()){var s=this.options.group,r=plus.nativeObj.Bitmap.getBitmapById(l.W2A_BITMAP_ID);r?(this.relatedView=new d(r.id,this.opener,s),this.relatedView.__wap2app_type="screenshot",this.relatedView.__wap2app_animate="group",this.relatedView.show("none",0,function(e){e?this.animating=!0:this.relatedView=!1,o()}.bind(this))):o()}else o()}},m._createTemplate=function(e){var t=this.options.template&&~this.options.template.indexOf(".ios.");if(!c.webviewAnimate()&&!t)return!1;if(!this.options.template||e===!1)return!1;var i=this.options.template,n=this.w2aContext.getTemplateWebviewById(i);if(!n)return!1;if(!n.restore)return!1;var a=plus.storage.getItem(l.W2A_TEMPLATE_DATA);if(!a)return!1;var o=this.options.show;this.relatedView=n,this.relatedView.restore(),this.relatedView.interceptTouchEvent(!0),this.relatedView.evalJS("window.__wap2app_render&&__wap2app_render("+a+")");this.options.screenshot;this.animating=!0,this.isTemplateAnimating=!0;var s=this.options.templateDelay||0;return setTimeout(function(){this.relatedView.show(o.aniShow,o.duration,function(){this.isTemplateAnimating=!1}.bind(this),{acceleration:"capture"})}.bind(this),s),!0},m._createAnimateViewDraws=function(e){var t=e.head,i=e.body,n=i.gif,a=[],o=this.options.id+"_nativeView_",s=t.color,r=parseInt(t.height),h=[];return n.src&&h.push({id:o+"gif",tag:"img",position:{top:(window.innerHeight-parseInt(n.height))/2,left:(window.innerWidth-parseInt(n.width))/2,width:n.width,height:n.height},src:"_www"+n.src}),h.push({id:o+"bg",tag:"rect",color:i.backgroundColor,position:{top:"0px",left:"0px",width:"100%",height:"100%"}}),r&&(a.push({id:o+"head_bg",tag:"rect",color:t.backgroundColor,position:{top:0,left:0,width:"100%",height:r}}),a.push({id:o+"head_border",tag:"rect",color:t.borderColor,position:{top:r,left:0,width:"100%",height:1/plus.screen.scale}}),a.push({id:o+"title",tag:"font",position:{top:0,left:0,width:"100%",height:r},text:t.title,textStyles:{size:t.fontSize,color:s}}),t.back&&a.push({id:o+"back",tag:"font",position:{top:0,left:0,width:44,height:44},text:"\ue601",textStyles:{size:"27px",color:s,src:t.iconfont}})),{head:a,body:h}},m._createAnimateView=function(){var e=this.options.show;if(!c.nativeViewDraws())return!1;if(this.options.extras.__wap2app_parent){var t=plus.webview.getWebviewById(this.options.extras.__wap2app_parent);if(t)return this.parentWebview=t,!0}var i=new w(this.options.id+"_nview",e.animate.nview,{location:o.getLocation(this.options.url)});return i.getView()?(this.relatedView=i,this.options.styles.statusbar&&i.getView().setStyle&&i.getView().setStyle({statusbar:{background:this.options.styles.statusbar.background}}),i.hasBack&&i.addEventListener("back",function(){wap2app.back()}),i.hasTabbar&&i.addEventListener("switchTab",function(e,t){wap2app.open(e.url,"",this.webview.id)}.bind(this)),!0):void 0},m._createScreenShot=function(e){var t=this.options.show;if(!this._createAnimateView()&&!this._createTemplate()){var i=this.options.screenshot,a=!0;if(i&&i.url){var o=this._getScreenshot();o&&(a=!1,c.nativeObj()?(!this.nativeView&&this._createNativeView(),this._drawTexts&&(i=n.extend(i,{drawText:this._drawTexts})),this.relatedView=new d(o,this.opener,i),this.options.styles.statusbar&&this.relatedView.view&&this.relatedView.view.setStyle&&this.relatedView.view.setStyle({statusbar:{background:this.options.styles.statusbar.background}}),this.relatedView.__wap2app_type="screenshot",this.nativeViewBitmap&&"_header"!==this.nativeViewBitmap.id.substr(-7)&&this.relatedView.setRecycle(!1),this.relatedView.show(e===!1?"none":t.aniShow,t.duration,function(e){e?this.animating=!0:this.relatedView=!1}.bind(this),function(){this.canTitleUpdate=!0,"startAnimation"===t.eventType&&this._titleUpdate()}.bind(this))):(this.relatedView=!1,this._createScreenShotFallback(o,this.options.show)))}a&&(this.canTitleUpdate=!0)}},m._getScreenshot=function(){if("function"==typeof this.options.screenshot.handle){var e=o.getLocation(this.options.url);return this.options.screenshot.handle(e.pathname,e)}return this.options.screenshot.url},m._createNativeView=function(){var e=this.options.screenshot;if(e&&e.view&&e.view.enable){var t=this._getScreenshot(),i=!1;if(c.bitmapRecycle()&&(i=plus.nativeObj.Bitmap.getBitmapById(t+"_header")),i||(i=plus.nativeObj.Bitmap.getBitmapById(t)),i){this.nativeViewBitmap=i;var n=e.view,a=this.options.id+"_nativeView_"+Math.random();this.nativeView=new d(a,n.styles,!1,e);var o=this.nativeView.view;"dock"===n.styles.position?"function"==typeof o.interceptTouchEvent&&o.interceptTouchEvent(!0):n.interceptTouchEvent?o.interceptTouchEvent(!0):o.interceptTouchEvent(!1),o.drawBitmap(i,n.crop.src,n.crop.dest),this._drawTexts=this.nativeView.drawTexts(o,e.drawText),("dock"===n.styles.position||n.interceptTouchEvent)&&this._handleNativeView(o)}}},m._handleNativeView=function(e){var t=this.options.screenshot.view;if(e&&"function"==typeof e.addEventListener){var i=t.click;i&&e.addEventListener("click",function(e){for(var t in i)if(i.hasOwnProperty(t)){var a=i[t];if(n.isCross(e.pageX,e.pageY,a.rect)){a.handle();break}}}.bind(this))}},m._createScreenShotFallback=function(e,t){this.relatedView||(this.relatedView=plus.webview.getWebviewById(e),this.relatedView?this.relatedView.show(t.aniShow,t.duration,function(){plus.nativeUI.closeWaiting(),this._showW2AViewFallback()}.bind(this)):(this.relatedView=plus.webview.create("_www/"+e,e,null,{__wap2app_type:"screenshot"}),this.relatedView.addEventListener("titleUpdate",function(){this.relatedView.show(t.aniShow,t.duration,function(){plus.nativeUI.closeWaiting(),this._showW2AViewFallback()}.bind(this))}.bind(this))))},m._showW2AViewFallback=function(){if(this.canTitleUpdate=!0,c.nativeObj()){var e=this.relatedView;this._createScreenshotAnimation(function(t){t&&e.hide("none")}.bind(this))}},m._createAppend=function(e){var t=this.options.show,i=this.options.parent;return i&&(this.canTitleUpdate=!0,"browser"===i?(this.relatedView=this.w2aContext.getBrowser(this.options.url,e,this.options._dock),this.relatedView.evalJS("wap2app_browser.loading();")):(this.relatedView=plus.webview.create("_www/"+i,this.options.id+"___wap2app_parent",{popGesture:"close",hardwareAccelerated:!0},{__wap2app_type:"parent"}),this.relatedView.addEventListener("titleUpdate",function(){this.relatedView.show(t.aniShow,t.duration)}.bind(this)))),this.relatedView},m._checkNetwork=function(){var e=plus.networkinfo.getCurrentType();e===plus.networkinfo.CONNECTION_CELL2G&&(this.options.show.eventType="rendering")},m._hasNetwork=function(e,t){return plus.networkinfo.getCurrentType()===plus.networkinfo.CONNECTION_NONE?(plus.nativeUI.confirm("\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8bbe\u7f6e",function(i){2===i.index?h.openAirPlaneModeSetting():1===i.index?this._create(e,t):0===i.index&&plus.runtime.quit()}.bind(this),"\u63d0\u793a",["\u9000\u51fa","\u91cd\u8bd5","\u8bbe\u7f6e\u7f51\u7edc"]),!1):!0},m._handleEvent=function(){var e=this;if(this.__loading=function(t){e._loading(t)},this.__titleUpdate=function(t){e._titleUpdate(t)},this.__loaded=function(t){e.options.navigationbar&&setTimeout(function(){e.webview.setStyle({backButtonAutoControl:"none"})},1e3),e._loaded(t)},this.__rendering=function(t){e.renderingTimer&&clearTimeout(e.renderingTimer),e._clearAnimation("rendering")},this.options.events.loading&&this.webview.addEventListener("loading",this.__loading),this._checkNetwork(),a.ios&&this.webview.addEventListener("popGesture",function(t){"start"===t.type&&this.animating&&e._clearAnimation("popGesture")}.bind(this)),this.webview.addEventListener("close",function(){this.w2aContext.refreshBijia()}.bind(this)),this.options.events.titleUpdate){var t=!1;if("plusready"!==this.options.show.eventType){this.titleUpdateTimer=setTimeout(function(){this._titleUpdate()}.bind(this),this.options.show.eventTimeout||2e3),"rendering"===this.options.show.eventType&&(n.getRuntimeInnerVersion()<26e3||a.ios?this.options.show.eventType="titleUpdate":t=!0);var i="startAnimation"===this.options.show.eventType?"titleUpdate":this.options.show.eventType;"titleUpdate"===i&&a.ios&&a.wkwebview&&(i="rendering"),this.webview.addEventListener(i,this.__titleUpdate)}}this.options.events.loaded&&(this.loadedTimer=setTimeout(function(){var e=function(){c.checkRenderedContent()?this.webview.checkRenderedContent({},function(t){t.rendered||(this.webview.stop(),plus.nativeUI.confirm("\u65e0\u6cd5\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8bbe\u7f6e",function(t){2===t.index?h.openAirPlaneModeSetting():1===t.index?(this.webview.loadURL(this.options.url),setTimeout(function(){e.call(this)}.bind(this),7e3)):0===t.index&&plus.runtime.quit()}.bind(this),"\u63d0\u793a",["\u9000\u51fa","\u91cd\u8bd5","\u8bbe\u7f6e\u7f51\u7edc"])),this._loaded("timer")}.bind(this),function(){this._loaded("timer")}.bind(this)):this._loaded("timer")};e.call(this)}.bind(this),7e3),this.webview.addEventListener("loaded",this.__loaded)),this.options.screenshot&&"rendering"===this.options.screenshot.animation.clear.eventType&&(n.getRuntimeInnerVersion()>=26e3?(this.webview.addEventListener("rendering",this.__rendering),this.renderingTimer=setTimeout(function(){this.__rendering({type:"rendering.timeout"})}.bind(this),6e3)):this.options.screenshot.animation.clear.eventType="loaded")},m._prepareLoading=function(){this.showing=!0;var e=this.options.showWaiting;if(e!==!1&&!this.backing&&this.webview&&this.webview.id!==l.W2A_BROWSER_CHILD_ID){if(c.nativeViewDraws()&&this.options.show.animate.nview.body.waiting.src)return;a.ios?plus.nativeUI.showWaiting(e.title,e.options):setTimeout(function(){plus.nativeUI.showWaiting(e.title,e.options)},20)}},m._loading=function(e){this.backing=!1,this.canEvalJS=!1,this._prepareLoading(),"function"==typeof this.options.loading&&this.options.loading(this.webview,this.backing),this._isBrowserWebview()&&(this._setPullToRefresh(this.webview.getURL())||(this.webview.setPullToRefresh({support:!0,style:"default"}),this.webview.setPullToRefresh({support:!1,style:"circle"})),this.relatedView.evalJS("wap2app_browser.loading();"))},m._createScreenshotAnimation=function(e){var t=this.options.screenshot,i=plus.nativeObj.Bitmap.getBitmapById(this._getScreenshot());if(i){var n=this.relatedView;this.relatedView=new d(i.id,null,t),this.relatedView.__wap2app_type="screenshot",this.relatedView.__wap2app_animate="fallback",this.relatedView.show("none",0,function(t){t||(this.relatedView=n),e&&e(t)}.bind(this))}else e&&e(!1)},m.show=function(e){this._titleUpdate(e)},m._titleUpdate=function(e){if(this.webview&&!this.backing){var t=e&&e.title||this.webview.getTitle()||"";if("null"===t&&(t=""),!t||"http"!==t.substr(0,4)&&"data"!==t.substr(0,4)||(t=""),this._isBrowserWebview()){if(this.options.title&&this.options.title.filter){var i=this.options.title.filter;"function"==typeof i&&(t=this.options.title.filter(t))}this.relatedView.evalJS("wap2app_browser.setTitle('"+encodeURIComponent(t||"")+"');")}else if(this.relatedView&&this.relatedView.setTitle){if(this.options.screenshot.title&&this.options.screenshot.title.enable&&!this.relatedView.drewTexts){var i=this.options.screenshot.title.filter;"function"==typeof i&&(t=i(t)),t&&(this.relatedView.setTitle(t,this.webview),this.nativeView&&this.nativeView.setTitle(t,this.webview))}}else if(this.navigationbar||this.options.navigationbar){var a=!1;"function"==typeof this.options.navigationbar.titleText?(a=!0,t=this.options.navigationbar.titleText(t)):this.options.navigationbar.titleText===!0?c.navigationbarTitle()||(a=!0):n.isObject(this.options.navigationbar.titleText)&&this.options.navigationbar.titleText.auto&&(a=!0,"function"==typeof this.options.navigationbar.titleText.filter&&(t=this.options.navigationbar.titleText.filter(t))),a&&t&&this.webview.setStyle({navigationbar:{titleText:n.ellipsis(t)}})}var o=this.options,s=o.show;this.titleUpdateTimer&&clearTimeout(this.titleUpdateTimer),this.titleUpdateTimer=!1;var r=function(){if(this.showing){this.showing=!1;var e=this.relatedView||!this.animate?"none":s.aniShow,t=this.relatedView||!this.animate?0:s.duration;this._show(e,t)}};o.delay?setTimeout(function(){r.call(this)}.bind(this),o.delay):r.call(this)}},m._show=function(e,t){if(!this.backing){if(this.shown)return void plus.nativeUI.closeWaiting();var i=this.options;if(this.shown=!0,i.showBehind&&!i.showBehind.isFirst&&this.opener)this.webview.showBehind(this.opener),plus.nativeUI.closeWaiting(),this.callback&&this.callback("shown",this.webview);else{if(!this._hasParentWebview()&&this.relatedView&&this.relatedView instanceof plus.webview.Webview&&this.relatedView.id!==l.W2A_BROWSER_ID){if(this.animating){var n=function(){this.isTemplateAnimating?setTimeout(function(){n.call(this)}.bind(this),100):(plus.nativeUI.closeWaiting(),this.webview.showBehind(this.relatedView),setTimeout(function(){
this.relatedView.animate(i.screenshot.animation,function(){this.relatedView.interceptTouchEvent(!1);var e=this;e.webviewTouchstart=function(){e.webview.removeEventListener("touchstart",e.webviewTouchstart),e._clearAnimation("touchstart")},this.webview.addEventListener("touchstart",e.webviewTouchstart),this.nativeObjAnimated=!0,"titleUpdate"===i.screenshot.animation.clear.eventType&&this._clearAnimation("titleUpdate"),plus.nativeUI.closeWaiting()}.bind(this))}.bind(this),0))};n.call(this)}}else if(this.relatedView&&this.relatedView instanceof w){var a=function(){this.animating?setTimeout(function(){a.call(this)}.bind(this),200):this.relatedView.animate(i.show.animate.animation,function(){this.nativeObjAnimated=!0,"titleUpdate"===i.show.animate.animation.clear.eventType&&this._clearAnimation("titleUpdate")}.bind(this))};a.call(this)}else this.webview.show(e,t,function(){if(this._handleShowBehindByOpen(),this._handleRedirectUrlByCookie(),this.relatedView)if(this.relatedView instanceof d)if("group"===this.relatedView.__wap2app_animate){var e=i.group.animation;plus.nativeUI.closeWaiting(),this.relatedView.close(e.type,e.duration,function(){this.nativeObjAnimated=!0,"titleUpdate"===i.screenshot.animation.clear.eventType&&this._clearAnimation("titleUpdate")}.bind(this))}else{plus.nativeUI.closeWaiting();var e=i.screenshot.animation;this.relatedView.close(e.type,e.duration,function(){var e=this;e.webviewTouchstart=function(){e.webview.removeEventListener("touchstart",e.webviewTouchstart),e._clearAnimation("touchstart")},this.webview.addEventListener("touchstart",e.webviewTouchstart),this.nativeObjAnimated=!0,"titleUpdate"===i.screenshot.animation.clear.eventType&&this._clearAnimation("titleUpdate")}.bind(this))}else if(this.relatedView instanceof plus.nativeObj.View){var e=i.screenshot.animation;this.relatedView.animate({type:e.type,duration:e.duration,frames:e.frames,region:e.region},function(){var e=this;e.webviewTouchstart=function(){e.webview.removeEventListener("touchstart",e.webviewTouchstart),e._clearAnimation("touchstart")},this.webview.addEventListener("touchstart",e.webviewTouchstart),this.nativeObjAnimated=!0,"titleUpdate"===i.screenshot.animation.clear.eventType&&this._clearAnimation("titleUpdate")}.bind(this))}else this._hasScreenshot()?setTimeout(function(){this.relatedView.hide("none"),plus.nativeUI.closeWaiting()}.bind(this),200):plus.nativeUI.closeWaiting();else plus.nativeUI.closeWaiting()}.bind(this));this.callback&&this.callback("shown",this.webview),i.blockNetworkImage&&"show"===i.blockNetworkImage&&this.webview.setBlockNetworkImage(!1)}}},m._handleShowBehindByOpen=function(){},m._handleShowBehindByBack=function(){},m._handleRedirectUrlByCookie=function(){if(this.options.isRedirect){var e=this.options.overrideUrlLoading.redirect.paramName;n.isObject(e)&&e.cookie&&e.cookie.url&&(this.redirect_url=p.get(e.cookie.url,e.cookie.name),this.redirect_url&&(this.redirect_url=decodeURIComponent(this.redirect_url)))}},m._loaded=function(e){if(this.canEvalJS=!0,!this.backing){if(plus.nativeUI.closeWaiting(),this.loaded)return void setTimeout(function(){plus.nativeUI.closeWaiting()},100);"timer"!==e&&(this.loaded=!0),this.loadedTimer&&clearTimeout(this.loadedTimer),this.loadedTimer=!1;var t=this.options;"function"==typeof t.loaded&&t.loaded(this.webview,this.backing),t.screenshot&&"loaded"===t.screenshot.animation.clear.eventType&&this._clearAnimation("loaded"),this._isBrowserWebview()&&this.relatedView.evalJS("wap2app_browser.loaded();"),!this.options.blockNetworkImage||this.options.blockNetworkImage!==!0&&"loaded"!==this.options.blockNetworkImage||this.webview.setBlockNetworkImage(!1),t.group&&t.group.limit&&this._clearGroupByLimit(t.extras.__wap2app_group,t.group.limit)}},m._clearAnimation=function(e){if(this.relatedView){var t=function(){this.webviewTouchstart&&this.webview.removeEventListener("touchstart",this.webviewTouchstart);var e;if(this.relatedView instanceof w?e=function(){plus.nativeUI.closeWaiting(),this.animating=!1,this.relatedView.hasTabbar||this.relatedView.close()}:this.relatedView instanceof d?e=function(){this.relatedView.clear(function(){plus.nativeUI.closeWaiting(),this.animating=!1}.bind(this))}:this.relatedView instanceof plus.nativeObj.View?e=function(){this.relatedView.close(),plus.nativeObj.View.clearAnimation(),plus.nativeUI.closeWaiting(),this.animating=!1}:!this._hasParentWebview()&&this.relatedView instanceof plus.webview.Webview&&this.relatedView.id!==l.W2A_BROWSER_ID&&(e=function(){var e=function(){this.nativeObjAnimated?(this.animating=!1,this.relatedView.hide("none",0,{acceleration:"none"}),this.relatedView.restore(),this.relatedView.interceptTouchEvent(!0),plus.nativeUI.closeWaiting(),plus.storage.removeItem(l.W2A_TEMPLATE_DATA),this.relatedView.evalJS("window.__wap2app_render&&__wap2app_render(false)")):setTimeout(function(){e.call(this)}.bind(this),150)};e.call(this)}),e){var t=this.options,i=0;t.screenshot&&t.screenshot.animation&&t.screenshot.animation.clear.delay&&(i=t.screenshot.animation.clear.delay),i?setTimeout(function(){e.call(this)}.bind(this),i):e.call(this)}};this.shown?t.call(this):setTimeout(function(){this._clearAnimation(e)}.bind(this),150)}},m._backByView=function(){var e=this.options,t=e.show,i=t.aniShow||"pop-in",n=t.duration||300;i=~i.indexOf("in")?i.replace("in","out"):i.replace("out","in"),this.webview.stop(),this.relatedView.animated?(this.relatedView.clear(),this.webview.close(i,n)):(this.relatedView.back(i,n),this.webview.close("none",0)),plus.nativeUI.closeWaiting()},m._backByTemplateWebview=function(){var e=this.options,t=e.show,i=t.aniShow||"pop-in",n=t.duration||300;i=~i.indexOf("in")?i.replace("in","out"):i.replace("out","in"),this.webview.stop(),this.webview.close("none",0),this.animating=!1,this.relatedView.hide(i,n,{acceleration:"none"}),this.relatedView.restore(),plus.storage.removeItem(l.W2A_TEMPLATE_DATA),this.relatedView.evalJS("window.__wap2app_render&&__wap2app_render(false)"),plus.nativeUI.closeWaiting(),this.clear()},m.destroy=function(){this._back(!0)},m._back=function(e){var t=this.options,i=t.show,n=i.aniShow||"pop-in",a=i.duration||300;n=~n.indexOf("in")?n.replace("in","out"):n.replace("out","in"),plus.nativeUI.closeWaiting();var o=this.webview;if(t.parent&&"browser"!==t.parent&&(o=this.webview.parent(),o||(o=this.webview)),!e&&o.__wap2app_group)for(var s=o.__wap2app_group.split(l.W2A_GROUP_SPLIT),r=0;r<s.length;r++){var h=s[r];h!==o.id&&h!==plus.runtime.appid&&plus.webview.close(h,"none",0)}if(this.webview.__wap2app_preload)o.hide(n,a),setTimeout(function(){o.setStyle({zindex:-1})},a);else{if(o.id===plus.runtime.appid)return void console.log("W2A[w2aWebviewContext]["+o.id+"]:back.close.prevent");(function(t){var i=function(){this._handleShowBehindByBack(),!e&&t.close(n,a,{acceleration:c.acceleration()?"auto":"none"}),this.w2aContext.restoreWebview()};t.__wap2app_group?setTimeout(function(){i.call(this)}.bind(this),50):i.call(this)}).bind(this)(o)}var p=t.back;p.reload&&setTimeout(function(){this._handleBackReload(p.reload)}.bind(this),100),this.w2aContext.removeContext(this.webview.id)},m._handleBackReload=function(e){if("function"==typeof e&&(e=e(location.pathname,location)),"boolean"==typeof e?this.opener&&e&&(e=[this.opener.id]):"string"==typeof e&&(e=[e]),n.isArray(e)&&e.length)for(var t=0;t<e.length;t++){var i=plus.webview.getWebviewById(e[t]);i&&i.reload()}},m.close=function(){this._back()},m._backBySpa=function(){if(this.history.length){var e=(this.history[this.history.length-1],this.options),t=e.show,i=t.aniShow||"pop-in",n=t.duration||300;i=~i.indexOf("in")?i.replace("in","out"):i.replace("out","in"),s.back(i,n,this.webview.id,{delay:e.back.delay,showWaiting:e.back.showWaiting})}else this.options.quit?this.quit():this._back()},m._backByWebview=function(e){this.webview.canBack(function(e){if(e.canBack)this.webview.id===l.W2A_BROWSER_CHILD_ID&&this.w2aContext.getBrowser().evalJS("wap2app_browser.showClose();"),this.webview.back();else{var t=!1,i=this.w2aContext.w2aOptions;if(this.webview.id===plus.runtime.appid){var n=this.webview.getURL();if(n&&"file:"!==o.getLocation(n).protocol){var a=i.getWebviewOptionsByUrl(n);a.isHome||(t=!0)}}t?wap2app.open(i.homeWebviewOptions.url,{reload:!0}):this.options.quit?this.quit():this._back()}}.bind(this))},m.updateOptions=function(e){n.isObject(e)&&(this.options=n.extend(this.options,e))},m.back=function(e,t){if(t!==!1){if(this.options.back.backbutton&&(this.canEvalJS||plus.runtime.appid===this.webview.id))return void this.webview.evalJS("window.wap2app&&wap2app.back();");this.options.back.backbutton||(e=!1)}if(this.relatedView&&this.animating){if(this.relatedView instanceof d){if(this.options.quit)return;return this.animating=!1,void this._backByView()}if(!this._hasParentWebview()&&this.relatedView instanceof plus.webview.Webview&&this.relatedView.id!==l.W2A_BROWSER_ID)return this.animating=!1,void this._backByTemplateWebview()}if(this.relatedView&&this.relatedView instanceof d&&this.relatedView.clear(),!this._hasParentWebview()&&this.relatedView&&this.relatedView instanceof plus.webview.Webview&&this.relatedView.id!==l.W2A_BROWSER_ID&&this.relatedView.isVisible()&&(this.relatedView.hide("none",0,{acceleration:"none"}),this.relatedView.restore()),this.backing=!0,e=e!==!1,this.options.isRedirect&&(e=!0),e)"spa"!==this.options.mode||this.webview.id===l.W2A_BROWSER_CHILD_ID?this._backByWebview():this._backBySpa();else{var i=!1,n=r();if(n&&n.__wap2app_bijia){var a=this.w2aContext.w2aOptions;if(this.webview.id===plus.runtime.appid){var s=this.webview.getURL();if(s&&"file:"!==o.getLocation(s).protocol){var h=a.getWebviewOptionsByUrl(s);h.isHome||(i=!0)}}}i?wap2app.open(a.homeWebviewOptions.url,{reload:!0}):this.options.quit?this.quit():this._back()}},m.quit=function(){this.options.back.backbutton===!1?this.plusQuit():this.webview.evalJS("window.wap2app&&wap2app.quit()")};var g=null;m.plusQuit=function(){g?+new Date-g<2e3&&plus.runtime.quit():(g=+new Date,plus.nativeUI.toast("\u518d\u6309\u4e00\u6b21\u9000\u51fa\u5e94\u7528"),setTimeout(function(){g=null},2e3))},m.changeDock=function(e){var t=!1,i="",n="";this._isBrowserWebview()?t=this.relatedView:this.nativeView&&(t=this.nativeView),t&&t.setStyle&&(this.webview.remove(t),e?(i="dock",n="dock"):(i="",n="absolute"),t.setStyle({dock:i,position:n}),this.webview.append(t))},m.open=function(e,t,i){this.w2aWebviewOverrideUrlLoading&&this.w2aWebviewOverrideUrlLoading.open(e,t,i)},m.handleOverrideUrlLoadingReject=function(){this.w2aWebviewOverrideUrlLoading&&this.w2aWebviewOverrideUrlLoading.reject()},m.clear=function(){this.cleared=!0,this.webview&&(this.webview.removeEventListener("loading",this.__loading),this.webview.removeEventListener("titleUpdate",this.__titleUpdate),this.webview.removeEventListener("loaded",this.__loaded),this.titleUpdateTimer&&clearTimeout(this.titleUpdateTimer),this.loadedTimer&&clearTimeout(this.loadedTimer),this.renderingTimer&&clearTimeout(this.renderingTimer))},e.exports=b},function(e,t,i){var n=i(7),a="TABITEM_TEXT_",o="TABITEM_IMAGE_",s="TABBAR_VIEW",r=20,h=function(e,t,i){this.id=e,this.options=t,this.itemClickCallback=i,this.view=!1,this.init()},p=h.prototype;p.init=function(){var e=this.options,t=e.list.length;this.itemWidth=(n.ios?plus.screen.resolutionWidth:window.innerWidth)/t,this.iconWidth=parseInt(e.iconWidth),this.iconHeight=parseInt(e.iconHeight),this.iconMarginLeft=(this.itemWidth-this.iconWidth)/2,this.itemHeight=parseInt(e.height),this.itemRects=[];for(var i=0;t>i;i++)this.itemRects.push({top:0,left:i*this.itemWidth,width:this.itemWidth,height:this.itemHeight});this.view=new plus.nativeObj.View(this.id+"_"+s,{top:plus.screen.resolutionHeight-plus.navigator.getStatusbarHeight()-this.itemHeight-(n.ios?41:0),height:this.itemHeight},this.getDraws()),this.view.interceptTouchEvent(!0),this.view.addEventListener("click",function(e){for(var t=e.clientX,i=e.clientY,n=0;n<this.itemRects.length;n++)this.isCross(t,i,this.itemRects[n])&&this.itemClickCallback&&this.itemClickCallback(this.options.list[n],n)}.bind(this))},p.getView=function(){return this.view},p.getDraws=function(){for(var e=this.options,t=[{id:"bg",tag:"rect",color:e.backgroundColor,position:{top:0,left:0,width:"100%",height:e.height}},{id:"border",tag:"rect",color:e.borderColor,position:{top:0,left:0,width:"100%",height:1/plus.screen.scale+"px"}}],i=0;i<e.list.length;i++){var n=e.list[i],s=(n.url,n.text),r=e.color,h=n.iconPath;e.selected===i&&(r=e.selectedColor,h=n.selectedIconPath);var p=this.getItemPosition(i,s);h&&t.push({id:o+"_"+i,tag:"img",position:p.icon,src:"_www/"+h}),s&&t.push({id:a+"_"+i,tag:"font",position:p.text,text:s,textStyles:{size:"12px",color:r}})}return t},p.isCross=function(e,t,i){return e>i.left&&e<i.left+i.width&&t>i.top&&t<i.top+i.height},p.getItemPosition=function(e,t){var i=(this.itemHeight-this.iconHeight)/2,n={};return t&&(i-=r/2,n.text={top:i+this.iconHeight,left:this.itemWidth*e,width:this.itemWidth,height:r}),n.icon={top:i,left:this.itemWidth*e+this.iconMarginLeft,width:this.iconWidth,height:this.iconHeight},n},e.exports=h},function(e,t,i){var n=i(6),a=i(7),o=i(11),s=i(14),r=i(13),h=i(39),p=h.globalOptions,l=h.webviewOptions,c=function(e){this._init(e)},d=c.prototype;d._init=function(e){this.globalOptions={},this.webviewsOptions={},this.homeWebviewOptions={},this.redirectWebviewOptions={},this.globalWebviewOptions={},this.defaultWebviewOptions=l,this._initGlobalOptions(e),this._initWebviewsOptions(e)},d._initGlobalOptions=function(e){var t=n.extend(p);e.lockOrientation&&(t.lockOrientation=e.lockOrientation),e.cookies&&(t.cookies=e.cookies),e.sms&&(t.sms=e.sms),e.feedback===!1?t.feedback=!1:n.isObject(e.feedback)&&(t.feedback=n.extend(t.feedback,e.feedback)),t.browser=n.extend(t.browser,e.browser),t.browser.header={height:parseInt(t.browser.styles[".header"].height,10)};var i=e.options||e.globalOptions;i&&i.navigationbar&&s.nativeViewDraws()&&(t.browser.fallback=!1),this.globalOptions=t},d._handlePagesAndTabs=function(e){if(e.pages&&e.pages.length){e.webviews={};for(var t=0;t<e.pages.length;t++){var i=e.pages[t];i.id=i.webviewId,e.webviews[i.id]=i}}if(e.webviews.launch&&e.webviews.launch.tabBar&&e.webviews.launch.tabBar.list&&e.webviews.launch.tabBar.list.length){var a={top:0,bottom:0,height:0,items:[],isNew:!0};a.items.push({url:window.__wap2app_old_tab_item_urls&&__wap2app_old_tab_item_urls[0]||"",matchPathnames:e.webviews.launch.matchPathnames});for(var t=0;t<e.webviews.launch.tabBar.list.length;t++)a.items.push(n.extend(e.webviews.launch.tabBar.list[t],{url:window.__wap2app_old_tab_item_urls&&__wap2app_old_tab_item_urls[t+1]||""}));e.webviews.launch.tab=a}},d._initWebviewsOptions=function(e){this._handlePagesAndTabs(e);var t={};this.globalWebviewOptions=e.globalOptions||e.options;for(var i in e.webviews){var a=n.isObject(e.webviews[i].back)&&e.webviews[i].back.hasOwnProperty("history"),o=this._initWebviewOptions(i,e.webviews[i]);if(i===r.W2A_LAUNCH_WEBVIEW_ID&&(o.quit=!0),i=o.quit?plus.runtime.appid:i,o.id=i,o.quit)o.isHome=!0,o.styles.render="always",o.styles.popGesture="none",o.network=!0,o.extras.__wap2app_type="home",a||(o.back.history=!1),this.homeWebviewOptions=o;else if(o.overrideUrlLoading){var h=o.overrideUrlLoading.redirect;(h.paramName||h.defaultUrl||h.handle)&&(this.redirectWebviewOptions[i]=this._handleRedirectWebviewOptions(o))}if(t[i]=o,s.nativeViewDraws()&&o.show.animate.nview.tabbar.list.length)for(var p=o.show.animate.nview.tabbar.list,l=0;l<p.length;l++)t[i+"_"+l]=n.extend(o,p[l].webview,{id:i+"_"+l,show:{animate:{nview:{tabbar:{selected:l}}}},extras:{__wap2app_tabbar:!0,__wap2app_parent:i}}),delete t[i];if(o.group)if(o.group.tabbar.list.length&&s.nativeViewDraws()){for(var c=[],d=o.group.tabbar,l=0;l<d.list.length;l++)c.push(i+"_"+l);var u=c.join(r.W2A_GROUP_SPLIT);o.extras.__wap2app_group=u,o.extras.__wap2app_tabbar=!0;for(var l=0;l<d.list.length;l++){var w=d.list[l];t[i+"_"+l]=n.extend(o,w.webview,{id:i+"_"+l,isHome:!1,group:{tabbar:{selected:l}},extras:{__wap2app_group:u}})}delete t[i]}else{for(var c=[i],v=o.group.matchPathnames,f=0;f<v.length;f++)c.push(i+"_"+(f+1));var u=c.join(r.W2A_GROUP_SPLIT);for(o.extras.__wap2app_group=u,f=0;f<v.length;f++)t[i+"_"+(f+1)]=n.extend(o,{id:i+"_"+(f+1),matchPathnames:v[f],isHome:!1,extras:{__wap2app_group:u}})}if(o.isHome&&s.drag()&&o.tab&&o.tab.items.length)for(f=0;f<o.tab.items.length;f++){var b=n.extend(o,o.tab.items[f],{id:o.tab.items[f].webviewId?o.tab.items[f].webviewId:o.id+(0===f?"":"_"+f)});0===f?b.isHome=!0:b.isHome=!1,b.extras.__wap2app_group="",t[i+"_"+f]=b}}if(!this.globalWebviewOptions.navigationbar){var m=this._convertOldVersion(this.globalOptions.browser.webview);if(m.matchHostnames||m.matchPathnames){var o=this._initWebviewOptions(r.W2A_BROWSER_CHILD_ID);o=n.extend(o,m),o.parent="browser",o.dock=this.globalOptions.browser.dock,o.title=this.globalOptions.browser.title,t[r.W2A_BROWSER_CHILD_ID]=o}}this.webviewsOptions=t},d._handleRedirectWebviewOptions=function(e){return"boolean"==typeof e.back.history&&(e.back.history=!0),e},d._initWebviewOptions=function(e,t){"undefined"==typeof t?t=e&&~e.indexOf(r.W2A_WEBVIEW_ID)?{id:e}:{id:r.W2A_WEBVIEW_ID+Math.random(),url:e}:n.isObject(t)||(t={id:e,matchPathnames:t}),t=n.extend(this.globalWebviewOptions,t);var i=n.isObject(t)&&n.isObject(t.back)&&"undefined"!=typeof t.back.history,o=n.isObject(t)&&n.isObject(t.screenshot)&&t.screenshot.title;n.isObject(t)&&n.isObject(t.screenshot)&&t.screenshot.view;t=n.extend(this.globalWebviewOptions,t);var h=n.isObject(t)&&n.isObject(t.navigationbar)&&s.nativeViewDraws();t=n.extend(l,t),h||(t.navigationbar=!1),this._convertOldVersion(t),"string"==typeof t.back&&(t.back=n.extend(l.back,{selector:t.back}));var p=t.show.animate.nview.head.title;if("string"==typeof p?t.show.animate.nview.head.title={titleUpdate:!1,handle:function(){return p}}:"function"==typeof p&&(t.show.animate.nview.head.title={titleUpdate:!1,handle:p}),s.nativeViewDraws()&&this._handleShowAnimateOptions(t),t.screenshot){"string"==typeof t.screenshot&&(t.screenshot=n.extend(l.screenshot,{url:t.screenshot})),t.screenshot.title&&("boolean"==typeof t.screenshot.title&&(t.screenshot.title=n.extend(l.screenshot.title,{enable:!0})),o&&n.isObject(t.screenshot.title)&&(t.screenshot.title.enable=!0));var c=t.screenshot.view;if("number"==typeof c){var d=c+"px";t.screenshot.view=n.extend(l.screenshot.view,{enable:!0,styles:{height:d},crop:{src:{height:d},dst:{height:d}}})}else if(n.isObject(c)&&c.height){var d=c.height+"px",u=c.dock;t.screenshot.view=n.extend(l.screenshot.view,{enable:!0,interceptTouchEvent:!!c.interceptTouchEvent,styles:{height:d,position:u?"dock":"absolute"},crop:{src:{height:d},dst:{height:d}},click:c.click||{}})}t.screenshot.view.enable||(t.screenshot.view=!1),t.screenshot.drawText&&n.isObject(t.screenshot.drawText)&&(t.screenshot.drawText=[t.screenshot.drawText])}"string"==typeof t.previewImage&&(t.previewImage=n.extend(l.previewImage,{selector:t.previewImage})),"boolean"==typeof t.gps&&(t.gps=n.extend(l.gps,{enable:t.gps})),!i&&"webview"===t.mode&&n.isArray(t.matchPathnames)&&(t.back.history=!1);var w=t.group,v=!1;if(w&&n.isArray(w.matchPathnames)&&w.matchPathnames.length){var f=w.matchPathnames;t.group.matchPathnames=f,w.drawText&&n.isObject(w.drawText)&&(t.group.drawText=[w.drawText]),t.styles.render="always",v=!0}v||(t.group=!1);var b={__wap2app_type:t.quit?"home":"normal"};return t.extras=n.extend(t.extras,b),a.ios&&(t.styles.kernel||(t.styles.kernel="WKWebview"),t.navigationbar&&"slide-in-right"===t.show.aniShow&&(t.show.aniShow="pop-in")),t},d._handleShowAnimateOptions=function(e){var t=e.show.animate;t.webview&&(e.template||(e.template=t.webview)),~t.nview.body.background.indexOf(".html")&&(e.screenshot.url=t.nview.body.background),t.nview.head.height&&(t.nview.head.dock?e.screenshot.view={enable:!0,height:t.nview.head.height,dock:t.nview.head.dock}:t.nview.head.dock===!1&&(e.screenshot.view=parseInt(t.nview.head.height))),t.nview.head.title.titleUpdate||(e.screenshot.drawText={text:t.nview.head.title.handle,max:25,dst:{height:t.nview.head.height},styles:{size:t.nview.head.fontSize,color:t.nview.head.color}}),t.nview.head.title.handle&&n.isObject(e.screenshot.title)&&(e.screenshot.title.enable=!0,e.screenshot.title.filter||(e.screenshot.title.filter=t.nview.head.title.handle)),(t.animation.top||t.animation.bottom)&&(e.screenshot=n.extend(e.screenshot,{animation:{frames:1,region:{top:t.animation.top,bottom:t.animation.bottom}}}))},d._convertOldVersion=function(e){return e.matchHostnames=e.matchHostnames||e.hostname,e.matchPathnames=e.matchPathnames||e.pathname,delete e.hostname,delete e.pathname,e.group&&e.group.pathname&&(e.group.matchPathnames=e.group.pathname,delete e.group.pathname),e},d.matchOptionsByUrl=function(e){for(var t in this.webviewsOptions){var i=this.webviewsOptions[t];if(n.isMatch(e,i))return i}return!1},d.getWebviewOptionsById=function(e){return this.webviewsOptions[e]||this._initWebviewOptions(e)},d.getRedirectWebviewOptionsByUrl=function(e){var t=o.getLocation(e);for(var i in this.redirectWebviewOptions){var a=this.redirectWebviewOptions[i];if(n.isMatch(t,a))return a}return!1},d.getWebviewOptionsByUrl=function(e){if(e){var t=!1,i=o.getLocation(e);if(i.href===this.homeWebviewOptions.url)return n.extend(this.homeWebviewOptions);if(t=this.matchOptionsByUrl(i))return n.extend(t);if(this.globalOptions.browser.fallback){var a=this.getWebviewOptionsById(r.W2A_BROWSER_CHILD_ID);return a=n.extend(a),a.mode="history",a.parent="browser",a._dock=!0,a}}return n.extend(this._initWebviewOptions(e))},d.isConfiged=function(e){var t=this.matchOptionsByUrl(o.getLocation(e));return t&&t.id!==r.W2A_BROWSER_CHILD_ID?t.id:!1},e.exports=c},function(e,t){e.exports={globalOptions:{debug:!1,ignore:!1,lockOrientation:"portrait-primary",globalOptions:{},webviews:{},cookies:!1,sms:{match:{sign:!1,length:6},callback:{webviewId:!1,handle:!1}},feedback:{url:"http://stream.dcloud.net.cn/wap2app/feedback",params:{app_name:"",app_vendor:"",about:"",ci:"",di:""}},browser:{url:!1,fallback:!0,webview:{mode:"history",matchHostnames:!1,matchPathnames:!1,reload:!0,pullToRefresh:{support:!0,style:"circle"}},dock:!1,styles:{".header":{height:"44px","background-color":"#efefef"},".back,.close":{color:"#8e8e93"},".title":{color:"#252525"},".progressbar":{"background-color":"#b6b6b6"},".progressbar span":{"background-color":"#ed2e2b"}}},shortcut:{enable:!1}},webviewOptions:{mode:"webview",url:"",quit:!1,cps:!1,matchHostnames:!1,matchPathnames:!1,preload:!1,blockNetworkImage:!1,fixBottom:!1,data:!1,subNViews:!1,navigationbar:{backgroundColor:"#1B1A1F",titleText:{auto:!1,filter:!1},titleColor:"#FFFFFF",borderColor:"",titleSize:"17px",icons:{back:!0,share:!1,home:!1}},fastclick:{className:"needsclick"},head:{handle:!1,point:{x:1,y:1},minWidth:window.innerWidth-50,maxHeight:70,placeholder:""},events:{titleUpdate:!0,loading:!0,loaded:!0},group:{matchPathnames:!1,placeholder:"#eee",limit:0,delay:0,report:{ignore:!1},tabbar:{selected:0,height:50,color:"#333333",selectedColor:"#ffffff",iconWidth:50,iconHeight:50,backgroundColor:"#ffffff",borderColor:"#333333",list:[]},activate:{container:!1,attribute:!1,itemMatch:!1,itemActiveClass:!1,activate:!1,deactivate:!1},drawText:{text:"",dst:{top:0,left:0,width:"100%",height:"100%"},styles:{size:"16px",color:"#000000",weight:"normal",style:"normal",family:""}},animation:{type:"shrink",duration:200,frames:12,region:{top:0,bottom:0,left:0,right:0}}},styles:{popGesture:"close",injection:!1,hardwareAccelerated:!0,errorPage:"_www/__wap2apperror.html"},fixed:{selector:"",styles:!1},extras:{},network:!0,ignore:!1,previewImage:{url:!1,selector:!1,options:!1,eventType:"click"},listenResourceLoading:{match:!1},overrideUrlLoading:{exclude:"none",block:!1,download:function(e,t){return/\.apk$/i.test(t.href)?{mode:"reject",msg:"\u5f53\u524d\u73af\u5883\u4e0d\u652f\u6301\u4e0b\u8f7d"}:void 0},delay:800,handle:!1,ignore:!1,replace:!1,redirect:{handle:!1,match:!1,defaultUrl:!1,paramName:!1,reload:!1},temporary:!1},overrideResourceRequest:!1,appendJsFile:!1,delay:0,show:{eventType:"titleUpdate",eventTimeout:2e3,aniShow:"slide-in-right",duration:300,animate:{webview:!1,nview:{draws:[],head:{draws:[],height:"",width:"100%",color:"#333333",borderColor:"#cccccc",backgroundColor:"#f0f0f0",fontSize:"17px",dock:"",title:{titleUpdate:!0,handle:!1},back:!0,share:!1,iconfont:"_www/__wap2app.ttf"},body:{draws:[],background:"#ffffff",crop:80,waiting:{src:"",width:"",height:""}},tabbar:{draws:[],position:"bottom",height:50,color:"#333333",selectedColor:"#ffffff",iconWidth:50,iconHeight:50,backgroundColor:"#ffffff",borderColor:"#333333",lineHeight:20,list:[]}},animation:{delay:0,top:"",bottom:"",clear:{eventType:"loaded",delay:0}}},showWaiting:{title:"",options:{modal:!1,back:"transmit",padlock:!0}}},history:!1,showWaiting:{title:"",options:{modal:!1,back:"transmit",padlock:!0}},template:!1,screenshot:{url:!1,handle:!1,title:{enable:!1,filter:!1,max:25,dst:{top:"0px",left:"0px",width:"100%",height:"44px"},styles:{size:"16px",color:"#000000",weight:"normal",style:"normal",family:""}},crop:80,drawText:{text:"",max:25,dst:{top:"0px",left:"0px",width:"100%",height:"100%"},styles:{size:"16px",color:"#000000",weight:"normal",style:"normal",family:""}},animation:{type:"shrink",duration:200,frames:12,region:{top:"0px",bottom:"0px",left:"0px",right:"0px"},clear:{eventType:"loaded",delay:0}},view:{enable:!1,height:0,dock:!1,interceptTouchEvent:!1,styles:{top:"0px",left:"0px",width:"100%",height:"100%",dock:"top",position:"absolute"},crop:{src:{top:"0px",left:"0px",width:"100%",height:"100%"},dst:{top:"0px",left:"0px",width:"100%",height:"100%"}},click:{back:{rect:{top:0,left:0,width:60,height:60},handle:function(){wap2app.currentWebview().evalJS("wap2app&&wap2app.back();")}}}}},back:{delay:500,showWaiting:!1,handle:!1,enable:!0,mask:{offset:{x:1,y:100},eventType:"click",handle:!1},backbutton:!0,override:!0,history:!0,selector:"",eventType:"click",beforeBack:!1,reload:!1,animation:{type:"shrink",duration:200,frames:12,region:{top:"0px",bottom:"0px",left:"0px",right:"0px"}}},loading:!1,loaded:!1,reload:!1,pullToRefresh:{support:!1,style:"circle"},injectStyle:!1,injectScript:!1,gps:{enable:!1,interval:1440,disabledMsg:"\u672c\u673a\u672a\u5f00\u542f\u5b9a\u4f4d\u529f\u80fd\uff0c\u70b9\u786e\u5b9a\u8fdb\u5165\u8bbe\u7f6e\u5f00\u542f\u5b9a\u4f4d\u529f\u80fd",forbiddenMsg:"\u5c1a\u672a\u8d4b\u4e88\u83b7\u53d6\u4f4d\u7f6e\u7684\u6743\u9650\u3002\u70b9\u786e\u5b9a\u8fdb\u5165\u8bbe\u7f6e\uff0c\u7ed9{app}\u8d4b\u4e88\u5b9a\u4f4d\u6743\u9650"},share:!1,report:{"no-default-screenshot":"\u65e0\u9ed8\u8ba4\u6a21\u7248","double-head":"\u53cc\u6807\u9898\u680f","no-head":"\u65e0\u6807\u9898\u680f","no-head-dock":"\u65b0\u589e\u6807\u9898\u680fdock\u5fc5\u987b\u4e3atrue","download-tips":"\u9876\u90e8\u5305\u542b\u4e0b\u8f7d\u6761","tab-changed":"\u9009\u9879\u5361\u53d1\u751f\u53d8\u5316{url}",mask:"\u6709\u906e\u7f69{mask}"}}}},function(e,t,i){var n=i(6),a=i(9),o=i(22),s=i(13),r=function(e){this._init(e)},h=r.prototype;h._init=function(e){this.w2aOptions=e,this.webview=plus.webview.currentWebview(),this.webviewOptions=this.w2aOptions.homeWebviewOptions,~["http:","https:"].indexOf(window.location.protocol)&&(this.webviewOptions=this.w2aOptions.getWebviewOptionsByUrl(window.location.href),this._handleLaunchWebview()),plus.screen.lockOrientation(e.globalOptions.lockOrientation||"portrait-primary"),this.webview.setStyle(this.webviewOptions.styles),this._initCookies(this.w2aOptions.globalOptions.cookies),this.webviewOptions.isHome||this._handleCpsWebview(this.w2aOptions.homeWebviewOptions.url)},h._initCookies=function(e){if(e){e=n.isArray(e)?e:[e];for(var t=0;t<e.length;t++){var i=e[t];i.url&&i.name&&o.set(i.url,i.name,i.value,i.expire)}}},h._handleLaunchWebview=function(){var e=this.webviewOptions.cps;if("string"==typeof e&&(e={"dcloud:streamapps":e}),n.isObject(e)){var t=e[plus.runtime.channel]||e["dcloud:streamapps"];t&&this._handleCpsWebview(t)}else e===!0&&a.get("https://stream.dcloud.net.cn/apps/cps",{appid:plus.runtime.appid,mc:plus.runtime.channel||"",vb:plus.runtime.innerVersion},function(e){e.url&&this._handleCpsWebview(e.url)}.bind(this))},h._handleCpsWebview=function(e){var t=plus.webview.getWebviewById(s.W2A_CPS_WEBVIEW_ID);t||(t=plus.webview.create(e,s.W2A_CPS_WEBVIEW_ID,{blockNetworkImage:!0}),setTimeout(function(){t&&(t.close(),t=null)}.bind(this),6e3),t.addEventListener("loaded",function(){if(t){var e=t.getURL();0===e.indexOf(this.w2aOptions.homeWebviewOptions.url)&&(t.close(),t=null)}}.bind(this)))},h.handleOldVersion=function(){this.webview.appendJsFile("_www/__wap2app.js"),this.webview.appendJsFile("_www/__wap2appconfig.js");var e=this.w2aOptions.homeWebviewOptions.appendJsFile;if("string"==typeof e&&e&&(e=[e]),n.isArray(e))for(var t=0,i=e.length;i>t;t++)e[t]&&this.webview.appendJsFile("_www/"+e[t]);window.location.replace(this.w2aOptions.homeWebviewOptions.url)},e.exports=r}]);